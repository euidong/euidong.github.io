<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta property="og:type" content="blog"/><meta property="og:site_name" content="JustLog"/><meta property="og:image" content="https://euidong.github.io/logo192.png"/><title>#MarkovRandomField | JustLog</title><meta name="description" content="#MarkovRandomField ê´€ë ¨ Posting"/><meta property="og:description" content="#MarkovRandomField ê´€ë ¨ Posting"/><meta property="og:title" content="#MarkovRandomField | JustLog"/><link rel="canonical" href="https://euidong.github.io/tags/MarkovRandomField"/><meta property="og:url" content="https://euidong.github.io/tags/MarkovRandomField"/><meta name="next-head-count" content="11"/><link rel="icon" href="https://euidong.github.io/favicon.png"/><link rel="apple-touch-icon" href="https://euidong.github.io/logo192.png"/><link rel="preload" href="/_next/static/css/d4ec5c8b3df09443.css" as="style"/><link rel="stylesheet" href="/_next/static/css/d4ec5c8b3df09443.css" data-n-g=""/><link rel="preload" href="/_next/static/css/6dc16d084a5153e5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6dc16d084a5153e5.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" id="Adsense-id" data-ad-client="ca-pub-7452732177557701" async="" defer="" data-nscript="beforeInteractive"></script><script src="/_next/static/chunks/webpack-9b312e20a4e32339.js" defer=""></script><script src="/_next/static/chunks/framework-81da43a8dcd978d9.js" defer=""></script><script src="/_next/static/chunks/main-7b6c38cbad60dfcf.js" defer=""></script><script src="/_next/static/chunks/pages/_app-123cccc552c680eb.js" defer=""></script><script src="/_next/static/chunks/675-ae8e8a351ce30ae2.js" defer=""></script><script src="/_next/static/chunks/pages/tags/%5Bsubject%5D-0fc8f67b45fbbd0f.js" defer=""></script><script src="/_next/static/iF6oy44c8AvnW0OMrDCE5/_buildManifest.js" defer=""></script><script src="/_next/static/iF6oy44c8AvnW0OMrDCE5/_ssgManifest.js" defer=""></script><script src="/_next/static/iF6oy44c8AvnW0OMrDCE5/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="Layout_wrapper__dKJSz root"><header class="Layout_header__XosLl" style="position:static"><div><button tabindex="1" class="SideBarToggler_search_bar_toggler__CEuUg"><svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 24 24" height="35px" width="35px" xmlns="http://www.w3.org/2000/svg"><path d="M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z" fill="currentColor"></path><path d="M2 12.0322C2 11.4799 2.44772 11.0322 3 11.0322H21C21.5523 11.0322 22 11.4799 22 12.0322C22 12.5845 21.5523 13.0322 21 13.0322H3C2.44772 13.0322 2 12.5845 2 12.0322Z" fill="currentColor"></path><path d="M3 17.0645C2.44772 17.0645 2 17.5122 2 18.0645C2 18.6167 2.44772 19.0645 3 19.0645H21C21.5523 19.0645 22 18.6167 22 18.0645C22 17.5122 21.5523 17.0645 21 17.0645H3Z" fill="currentColor"></path></svg></button><nav class="SideBar_side_bar__wrapper--close__8Nwnr"><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/">Home</a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/tags">Tags</a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/categories/Algorithm">Algorithm<!-- --><span class="SideBar_side_bar__li__cnt__9QV_z">(<!-- -->11<!-- -->)<!-- --></span></a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/categories/Computer%20Architecture">Computer Architecture<!-- --><span class="SideBar_side_bar__li__cnt__9QV_z">(<!-- -->7<!-- -->)<!-- --></span></a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/categories/Tech">Tech<!-- --><span class="SideBar_side_bar__li__cnt__9QV_z">(<!-- -->17<!-- -->)<!-- --></span></a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/categories/Web">Web<!-- --><span class="SideBar_side_bar__li__cnt__9QV_z">(<!-- -->4<!-- -->)<!-- --></span></a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/categories/Paper">Paper<!-- --><span class="SideBar_side_bar__li__cnt__9QV_z">(<!-- -->2<!-- -->)<!-- --></span></a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/categories/Network">Network<!-- --><span class="SideBar_side_bar__li__cnt__9QV_z">(<!-- -->11<!-- -->)<!-- --></span></a><a class="SideBar_side_bar__li__crDBH" tabindex="-1" href="/categories/AI">AI<!-- --><span class="SideBar_side_bar__li__cnt__9QV_z">(<!-- -->20<!-- -->)<!-- --></span></a></nav></div><a class="Logo_logo___yD0t" tabindex="1" href="/"></a><div><button class="SearchBarToggler_search_bar_toggler__3dHbA" tabindex="2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="25px" width="25px" xmlns="http://www.w3.org/2000/svg"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"></path></svg></button></div></header><section><div class="RowCard_row_card__list__background___xFj5"><h1 class="RowCard_row_card__list__title__t4a2h"> Markov Random Field</h1><label class="RowCard_row_card__list__select__wrapper__TZ4_9"><select class="RowCard_row_card__list__select__dxkxA"><option class="RowCard_row_card__list__select__option__GRKZU">ìµœì‹ ìˆœ<!-- --></option><option class="RowCard_row_card__list__select__option__GRKZU">AtoZ<!-- --></option><option class="RowCard_row_card__list__select__option__GRKZU">ZtoA<!-- --></option></select></label><ul class="RowCard_row_card__list__wrapper__5Gtgi"><div class="RowCard_row_card__wrapper__kohuv"><a class="RowCard_row_card__thumbnail__wrapper__bedY4" href="/posts/ml-graphical-model"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:200px;height:200px;background:none;opacity:1;border:0;margin:0;padding:0;position:relative"><img alt="[ML] 8. Graphical Model" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="fixed" class="RowCard_row_card__thumbnail__Dh_84" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover"/><noscript><img alt="[ML] 8. Graphical Model" srcSet="https://euidong.github.io/images/ml-thumbnail.jpg?imwidth=256 1x, https://euidong.github.io/images/ml-thumbnail.jpg?imwidth=640 2x" src="https://euidong.github.io/images/ml-thumbnail.jpg?imwidth=640" decoding="async" data-nimg="fixed" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover" class="RowCard_row_card__thumbnail__Dh_84" loading="lazy"/></noscript></span></a><div class="RowCard_row_card__tray__trcA5"><a class="RowCard_row_card__tray__title__lVniM" tabindex="-1" href="/posts/ml-graphical-model">[ML] 8. Graphical Model</a><div class="RowCard_row_card__tray__date__3cY_j">2022ë…„ 11ì›” 14ì¼ 13ì‹œ 08ë¶„</div><ul class="RowCard_row_card__tray__tag__qXmOl"><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/ML"># <!-- -->ML<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/GraphicalModel"># <!-- -->GraphicalModel<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/ConditionalIndependence"># <!-- -->ConditionalIndependence<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/MarkovRandomField"># <!-- -->MarkovRandomField<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/BayesianNetwork"># <!-- -->BayesianNetwork<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/FactorGraph"># <!-- -->FactorGraph<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/D-Seperation"># <!-- -->D-Seperation<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/Factorization"># <!-- -->Factorization<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/MarkovProperty"># <!-- -->MarkovProperty<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/MessagePassing"># <!-- -->MessagePassing<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/BeliefPropagation"># <!-- -->BeliefPropagation<!-- --></a><a class="RowCard_row_card__tray__tag__li__7_3Zt" tabindex="-1" href="/tags/Chow-LiuAlgorithm"># <!-- -->Chow-LiuAlgorithm<!-- --></a></ul></div></div></ul></div></section><footer class="Layout_footer__EL5v8"><div class="Layout_footer__copyright__r5baC"><span>Copyright Â© euidong</span><br/><span>ëª¨ë“  ì»¨í…ì¸ ì— ëŒ€í•œ ì €ì‘ê¶Œì€ ì‘ì„±ìì—ê²Œ ì¡´ì¬í•©ë‹ˆë‹¤. <!-- --><br/>ë¶ˆë²• ë³µì œë¥¼ í†µí•œ ìƒì—…ì  ì‚¬ìš©ì„ ì ˆëŒ€ì ìœ¼ë¡œ ê¸ˆì§€í•©ë‹ˆë‹¤. <!-- --><br/>ë‹¨, ë¹„ìƒì—…ì  ì´ìš©ì˜ ê²½ìš° ì¶œì²˜ ë° ë§í¬ë¥¼ ì ìš©í•œë‹¤ë©´ ììœ ë¡­ê²Œ ì‚¬ìš©ê°€ëŠ¥ í•©ë‹ˆë‹¤.<!-- --></span><span>Also I use photos by<!-- --> <!-- --><a href="https://unsplash.com/@lorenzoherrera?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" tabindex="-1">Lorenzo Herrera</a> <!-- -->on<!-- --> <!-- --><a href="https://unsplash.com/s/photos/tech?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" tabindex="-1">Unsplash</a></span></div><div class="Layout_footer__contents__YZWSm"><a class="Layout_footer__contents__link__K_TKH" href="https://github.com/euidong" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="60" width="60" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg><span>github</span></a><a class="Layout_footer__contents__link__K_TKH" href="https://euidong.github.io/portfolio" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="60" width="60" xmlns="http://www.w3.org/2000/svg"><path d="M6 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-5 6s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zM11 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5zm.5 2.5a.5.5 0 0 0 0 1h4a.5.5 0 0 0 0-1h-4zm2 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2zm0 3a.5.5 0 0 0 0 1h2a.5.5 0 0 0 0-1h-2z"></path></svg><span>portfolio</span></a><a class="Layout_footer__contents__link__K_TKH" href="https://chrome.google.com/webstore/detail/bonfire/nkooidijgbppkojdgkoafcoppnohdfka?hl=ko" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" version="1.1" viewBox="0 0 16 16" height="60" width="60" xmlns="http://www.w3.org/2000/svg"><path d="M5.016 16c-1.066-2.219-0.498-3.49 0.321-4.688 0.897-1.312 1.129-2.61 1.129-2.61s0.706 0.917 0.423 2.352c1.246-1.387 1.482-3.598 1.293-4.445 2.817 1.969 4.021 6.232 2.399 9.392 8.631-4.883 2.147-12.19 1.018-13.013 0.376 0.823 0.448 2.216-0.313 2.893-1.287-4.879-4.468-5.879-4.468-5.879 0.376 2.516-1.364 5.268-3.042 7.324-0.059-1.003-0.122-1.696-0.649-2.656-0.118 1.823-1.511 3.309-1.889 5.135-0.511 2.473 0.383 4.284 3.777 6.197z"></path></svg><span>chat</span></a></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"content":"\n## Intro\n\nMachine Learningì€ ì£¼ì–´ì§„ dataë¥¼ ê°€ì¥ ì˜ ì„¤ëª…í•  ìˆ˜ ìˆëŠ” pattern(Model)ì„ ì°¾ëŠ” ê²ƒì´ ëª©í‘œë¼ê³  í•˜ì˜€ë‹¤. ê·¸ë ‡ë‹¤ë©´, \"dataê°€ ê°€ì§€ëŠ” ì—¬ëŸ¬ê°€ì§€ ì •ë³´(feature)ë“¤ ì¤‘ì—ì„œ ì–´ë–¤ featureë¥¼ ì¤‘ì ì ìœ¼ë¡œ ë³´ê³  ì´ìš©í•  ìˆ˜ ìˆì„ê¹Œ?\" ê·¸ë¦¬ê³ , \"ë§Œì•½ ì—¬ëŸ¬ featureë“¤ì´ ì„œë¡œ ì—°ê´€ì´ ìˆë‹¤ë©´ ì´ë¥¼ ì—°ì‚°ì˜ ìµœì í™”ë¥¼ ìœ„í•´ ì´ìš©í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ?\" ë¼ëŠ” ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. ì—¬ê¸°ì„œ Graphical Modelì€ ì´ëŸ¬í•œ ê´€ê³„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ì„œ ì—°ì‚° ìµœì í™”ì— ëŒ€í•œ insightë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.\n\n## Relation\n\nê° featureë“¤ ì¦‰, Random Variableë“¤ ê°„ì˜ ê´€ê³„ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤.\n\n1. **Correlation(ìƒê´€ê´€ê³„)**  \n   ì‰½ê²Œ ìƒê°í•˜ë©´ ë‘ Random Variableì´ ìˆì„ ë•Œ, ì„œë¡œê°€ ê°’ ì¶”ì •ì— ì˜í–¥ì„ ì¤€ë‹¤ëŠ” ê²ƒì´ë‹¤. ì¦‰, íŠ¹ì • Random Variableì˜ ê°’ì´ ê´€ì¸¡ë˜ì—ˆì„ ë•Œ, Random Variableì´ ê°€ì§€ëŠ” ê°’ì˜ ë²”ìœ„ê°€ ì œí•œë˜ê³ , í™•ë¥ ì´ ë³€í™”í•œë‹¤.  \n   ì¦‰, $X$ì™€$Y$ê°€ ì„œë¡œ Correlationì´ ì¡´ì¬í•œë‹¤ë©´, $P(X) \\neq P(X|Y)$  \n   ê·¸ë ‡ê¸°ì— ë‘ Random Variableì´ ì„œë¡œ ë…ë¦½(independence)ì´ë¼ë©´, Correlationì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤.  \n2. **Causality(ì¸ê³¼ê´€ê³„)**  \n   ì‰½ê²Œ Correlationê³¼ í—·ê°ˆë¦´ ìˆ˜ ìˆì§€ë§Œ, CausalityëŠ” ì›ì¸ê³¼ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚˜ëŠ” ê´€ê³„ë¥¼ ì˜ë¯¸í•œë‹¤. ì‰¬ìš´ ì˜ˆì‹œë¡œ Xë¼ëŠ” ì‚¬ê±´ê³¼ Yë¼ëŠ” ì‚¬ê±´ì´ ë¹ˆë²ˆí•˜ê²Œ ê°™ì´ ë°œìƒí•œë‹¤ê³ , ì‰½ê²Œ Xë¼ëŠ” ì‚¬ê±´ì´ Yì˜ ì›ì¸ì´ë¼ê³  ë§í•  ìˆ˜ëŠ” ì—†ëŠ” ê²ƒê³¼ ê°™ì€ ì›ë¦¬ì´ë‹¤. ë˜í•œ, ì¤‘ìš”í•œ íŠ¹ì§• ì¤‘ì— í•˜ë‚˜ëŠ” ë°©í–¥ì´ ë¶„ëª…í•˜ë‹¤ëŠ” ê²ƒì´ë‹¤. ì›ì¸ê³¼ ê²°ê³¼ëŠ” ëŒ€ê²Œ ë¶„ë¦¬ë˜ê¸° ë•Œë¬¸ì— ì›ì¸ì´ ë˜ëŠ” ì‚¬ê±´ê³¼ ê²°ê³¼ê°€ ë˜ëŠ” ì‚¬ê±´ì´ ë¶„ëª…ì´ êµ¬ë¶„ëœë‹¤. ê²°ë¡ ì ìœ¼ë¡œ, Causalityë¥¼ ê°€ì§€ëŠ” ë‘ ì‚¬ê±´ì€ ì„œë¡œ Correlationì´ ìˆëŠ” ê²ƒì€ ìëª…í•˜ì§€ë§Œ, Correlationì´ ì¡´ì¬í•œë‹¤ê³  Causalityë¥¼ ë‹¨ì •í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ì¦‰, Correlationì´ Causalityë¥¼ í¬í•¨í•˜ëŠ” ê°œë…ì´ë‹¤. ê·¸ë ‡ê¸°ì— ì„œë¡œ ë…ë¦½ì´ë¼ë©´, Causalityë„ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤.\n3. **Independence(ë…ë¦½)**  \n   ìœ„ì— ì œì‹œëœ ë‘ ê°€ì§€ëŠ” dependence ê´€ê³„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì´ëŠ” ë‘ Random Variableì˜ ê°’ì´ ì„œë¡œì˜ ê°’ì— ì˜í–¥ì„ ì „í˜€ ì£¼ì§€ ì•ŠìŒì„ ì˜ë¯¸í•œë‹¤.  \n   ì¦‰, $X$ì™€ $Y$ê°€ ì„œë¡œ ë…ë¦½í•˜ë‹¤ë©´, $P(X) = P(X|Y), P(Y) = P(Y|X)$ì´ë‹¤.  \n   (ê²°ê³¼ì ìœ¼ë¡œ Independenceê°€ ì•„ë‹ˆë¼ë©´ ìµœì†Œí•œì˜ Correlationì´ ì¡´ì¬í•œë‹¤.)\n\nì´ëŸ¬í•œ ê´€ê³„ë¥¼ ì–´ë–»ê²Œ í™œìš©í•  ìˆ˜ ìˆì„ì§€ë¥¼ ê³ ë¯¼í•´ë³´ì. ìš°ë¦¬ê°€ ì§‘ì¤‘ì ìœ¼ë¡œ ì‚´í´ë³¼ ê²ƒì€ **Independence**ì´ë‹¤. ë§Œì•½, ìš°ë¦¬ê°€ êµ¬í•˜ê³ ì í•˜ëŠ” ê²°ê³¼ê°’($Y$)ê°€ ì¡´ì¬í•  ë•Œ, íŠ¹ì • feature($X_{1}$)ê°€ ì„œë¡œ ë…ë¦½í•œë‹¤ê³  í•˜ì. $P(Y|X_{1})=P(Y)$ì— ì˜í•´ì„œ $X_{1}$ëŠ” ì „í˜€ ì“¸ëª¨ê°€ ì—†ëŠ” ì •ë³´ì„ì„ ì•Œ ìˆ˜ê°€ ìˆë‹¤. ì´ë ‡ê²Œ ëª…í™•í•œ independenceë¥¼ ì•ˆë‹¤ë©´ í•´ë‹¹ featureë¥¼ Learning ë° Estimationì—ì„œ ì œê±°í•˜ëŠ” ê²ƒì€ ì‰¬ìš¸ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ, ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ ê´€ê³„ë¥¼ ëª…í™•í•˜ê²Œ ë°íˆê¸° ì–´ë ¤ìš¸ ë•Œê°€ ë§ë‹¤. ê·¸ë ‡ë‹¤ë©´ ê²°êµ­ ìš°ë¦¬ê°€ Machine Learningì„ í†µí•´ì„œ êµ¬í•˜ê³ ì í•˜ëŠ” ì‹ì¸ ì•„ë˜ ì‹ì„ ì–´ë–»ê²Œ í•˜ë©´ ì¢€ ë” ìµœì í™”í•  ìˆ˜ ìˆì„ê¹Œ?\n\n$$\nP(Y|X_{1}, X_{2}, \\cdots, X_{N}) = \\frac{P(Y, X_{1}, X_{2}, \\cdots, X_{N})}{P(X_{1}, X_{2}, \\cdots, X_{N})}\n$$\n\nì—¬ê¸°ì„œì˜ í•µì‹¬ì€ ë°”ë¡œ **Joint Probability**ì— ìˆë‹¤. ìš°ë¦¬ëŠ” ê²°êµ­ ì¢‹ë“  ì‹«ë“  **Joint Probability**ë¥¼ êµ¬í•´ì•¼ í•œë‹¤.\n\n$$\n\\begin{align*}\nP(X_{1}, X_{2}, \\cdots, X_{N}) \u0026= P(X_{1} | X_{2}, X_{3}, \\cdots, X_{N}) \\times P(X_{2}, X_{3}, \\cdots, X_{N})\\\\\n\u0026= P(X_{1} | X_{2}, X_{3}, \\cdots, X_{N}) \\times P(X_{2} |, X_{3}, X_{4}, \\cdots, X_{N}) \\times P(X_{3}, X_{4}, \\cdots, X_{N}) \\\\\n\u0026= \\prod_{i=1}^{N} P(X_{i} | X_{i+1}, X_{i+2}, \\cdots, X_{N})\n\\end{align*}\n$$\n\nìœ„ì— ì œì‹œí•œ **Probability Chain Rule**ì— ì˜í•´ì„œ ìš°ë¦¬ëŠ” Joint ProbabilityëŠ” ê°ê°ì˜ Random Variable ì˜ Conditional Probabilityë¼ê³  í•  ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´, ìš°ë¦¬ëŠ” Random Variableì´ Nê°œ ìˆê³ , ê° Random Variableì˜ dimensionì´ Lì´ë¼ê³  í•  ë•Œ, ë‹¤ìŒê³¼ ê°™ì•„ì§ì„ ì•Œ ìˆ˜ ìˆë‹¤.\n\n$$\nL^{N} \\times L^{N-1} \\times \\cdots \\times L^{1} = O(L^{N})\n$$\n\nì´ëŸ¬í•œ ì—°ì‚°ì„ ì–´ë–»ê²Œ í•˜ë©´ ì¢€ ë” ìµœì í™”í•  ìˆ˜ ìˆì„ê¹Œ? HintëŠ” Conditional Probability ê° ê°ì˜ ë³€ìˆ˜ì˜ ì–‘ì„ ì¤„ì´ëŠ” ê²ƒì´ë‹¤. ìš°ë¦¬ê°€ ì–´ë–¤ ê´€ê³„ê°€ ìˆì„ ë•Œ, ì´ Random Variableì˜ ê°¯ìˆ˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆì„ê¹Œ? ë°”ë¡œ ë³€ìˆ˜ ê°„ Conditional Independenceê°€ ì´ì— ëŒ€í•œ í•´ë‹µì„ ì œì‹œí•œë‹¤.\n\n### Conditional Independence\n\nConditional IndependenceëŠ” Conditional Probabilityì²˜ëŸ¼ íŠ¹ì • ì •ë³´(ë‹¤ë¥¸ Random Variableì˜ ê°’)ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ë‘ Random Variableì´ ì„œë¡œ ë…ë¦½ì´ë¼ëŠ” ê²ƒì´ë‹¤.\n\nì‰½ê²Œ ì˜ˆë¥¼ ë“¤ì–´ ì„¤ëª…í•œë‹¤ë©´, \"ê³¼ìŒ\"ê³¼ \"ë¹¨ê°„ ì–¼êµ´\" ì‚¬ì´ì˜ ê´€ê³„ë¼ê³  í•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ìš°ë¦¬ëŠ” \"ë¹¨ê°„ ì–¼êµ´\"ì¸ ì‚¬ëŒì´ \"ê³¼ìŒ\"ì„ í–ˆì„ ê²ƒì´ë¼ê³  íŒë‹¨í•  ê²ƒì´ë‹¤. ì¦‰, \"ë¹¨ê°„ ì–¼êµ´\"ê³¼ \"ê³¼ìŒ\" ì‚¬ì´ì—ëŠ” ê´€ê³„ê°€ ì¡´ì¬í•œë‹¤(dependency). í•˜ì§€ë§Œ, \"í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„\"ë¼ëŠ” ì •ë³´ê°€ ì£¼ì–´ì§„ë‹¤ë©´ ì–´ë–¨ê¹Œ? \"í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„\"ê°€ ì£¼ì–´ì§„ë‹¤ë©´, ì‚¬ì‹¤ \"ë¹¨ê°„ ì–¼êµ´\"ì€ ë” ì´ìƒ \"ê³¼ìŒ\" ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ” ê¸°ì¤€ì— ì˜í–¥ì„ 1ë„ ì£¼ì§€ ì•Šì„ ê²ƒì´ë‹¤. ì´ë•Œì—ëŠ” \"ê³¼ìŒ\"ê³¼ \"ë¹¨ê°„ ì–¼êµ´\"ì€ independenceí•˜ë‹¤. ìš°ë¦¬ëŠ” ì´ëŸ° ê²½ìš°ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.\n\n$$\n\\text{ê³¼ìŒ} \\not\\!\\perp\\!\\!\\!\\perp \\text{ë¹¨ê°„ ì–¼êµ´}\n$$\n$$\n\\text{ê³¼ìŒ} \\perp\\!\\!\\!\\!\\perp \\text{ë¹¨ê°„ ì–¼êµ´} |\\ \\text{í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„}\n$$\n\nì¦‰, í™•ë¥ ì— ì ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n$$\nP(\\text{ê³¼ìŒ} | \\text{ë¹¨ê°„ ì–¼êµ´, í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„}) = P(\\text{ê³¼ìŒ} | \\text{í˜ˆì¤‘ ì•Œì½”ì˜¬ ë†ë„})\n$$\n\nì—¬ê¸°ì„œ ìš°ë¦¬ê°€ í•˜ê³  ì‹¶ì—ˆë˜ ê²ƒì´ ë‚˜ì™”ë‹¤. ë°”ë¡œ \"ë¹¨ê°„ ì–¼êµ´\"ì´ë¼ëŠ” Random Variableì´ ì—†ì–´ì¡Œë‹¤. ì¦‰, \"ê³¼ìŒ\"ê³¼ \"ë¹¨ê°„ ì–¼êµ´\" ì‚¬ì´ì˜ ê´€ê³„ ê°™ì€ ê²ƒì„ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´, ìš°ë¦¬ëŠ” ê³„ì‚° ê³¼ì •ì„ ë‹¨ìˆœí™”í•  ìˆ˜ ìˆë‹¤.\n\nì¦‰, ì´ê²ƒì´ ìš°ë¦¬ê°€ **Graph**ë¥¼ í†µí•´ì„œ ì°¾ê³ ì í•˜ëŠ” ê²ƒì´ë‹¤.\n\n## Graphical Model\n\n**Graphical Model**ì€ **Graph**ë¥¼ ì´ìš©í•´ì„œ Random Variableë“¤ì˜ ê´€ê³„ë¥¼ í‘œí˜„í•˜ê³ , ì´ë¥¼ í†µí•´ì„œ **Joint Probability**ë¥¼ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì´ë‹¤. **Graph**ë¥¼ ê·¸ë¦¬ëŠ” ë°©ë²•ì€ ê¸°ë³¸ì ìœ¼ë¡œ Random Variable í•˜ë‚˜ í•˜ë‚˜ê°€ Graphì˜ Nodeê°€ ë˜ê³ , ê° Nodeê°„ì˜ ê´€ê³„ê°€ Edgeê°€ ëœë‹¤. ê·¸ëŸ°ë°, ì´ ê´€ê³„ê°€ Correlationì´ëƒ, Causalityëƒì— ë”°ë¼ì„œ ë‘ ê°€ì§€ ì¢…ë¥˜ë¡œ ë‚˜ë‰˜ê²Œ ëœë‹¤. \u003cmark\u003e**Correlation**ì€ ì¼ë°˜ì ìœ¼ë¡œ ê´€ê³„ì˜ ë°©í–¥ì´ ì—†ê¸°ì— **Undirected Graph**\u003c/mark\u003eë¡œ í‘œí˜„í•˜ê³ , \u003cmark\u003e**Causality**ëŠ” ê´€ê³„ì˜ ë°©í–¥ì´ ìˆê¸°ì— **Directed Graph**\u003c/mark\u003eë¡œ í‘œí˜„í•œë‹¤. ì´ëŠ” ì•„ë˜ì—ì„œ ë” ìì„¸íˆ ë‹¤ë£¨ë„ë¡ í•˜ê² ë‹¤.\n\n### Markov Random Field(Undirected Graphical Model, Correlation)\n\n**Markov Random Field**(MRF)ë¼ê³  ë¶ˆë¦¬ë©°, **Correlation**ë¥¼ í‘œí˜„í•œ Graphì´ë‹¤. ê° NodeëŠ” Random Variableì„ ì˜ë¯¸í•˜ë©°, EdgeëŠ” Correlationë¥¼ ì˜ë¯¸í•œë‹¤. ì¦‰, ë‘ Nodeê°€ Edgeë¡œ ì—°ê²°ë˜ì–´ ìˆë‹¤ë©´, ë‘ Random Variableì€ Independenceí•˜ì§€ ì•Šë‹¤ëŠ” ê²ƒì´ë‹¤.\n\n![ml-undirected-graph-1](/images/ml-undirected-graph-1.jpg)\n\nì—¬ê¸°ì„œ ì¤‘ìš”í•œ ê²ƒì€ Random Variableì„ ëŒ€í‘œí•˜ëŠ” Nodeì™€ Correlationì„ ëŒ€í‘œí•˜ëŠ” Edgeì´ê¸° ë•Œë¬¸ì—, Graph $G=(V, E)$ì—ì„œ Random Variableì˜ ì§‘í•© $X = \\{X_{1}, X_{2}, \\cdots, X_{|V|}\\}$ì´ê³ , $\\{1,2, \\cdots, |V|\\}$ê°€ ì£¼ì–´ì§ˆ ë•Œ ë°˜ë“œì‹œ ì•„ë˜ì— ì œì‹œëœ **Markov Propertyë“¤**ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.\n\n1. \u003cmark\u003e**Pairwise Markov Property**\u003c/mark\u003e  \n   ì¸ì ‘í•˜ì§€ ì•Šì€ Node ë‘ ê°œëŠ” ë‹¤ë¥¸ ëª¨ë“  Nodeê°€ ì£¼ì–´ì§ˆ ë•Œ conditionally independentí•˜ë‹¤.  \n   (ì•„ë˜ì—ì„œ \\ëŠ” í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.)\n   $$\n   X_{i} \\perp\\!\\!\\!\\!\\perp X_{j} | X_{S\\backslash\\{i, j\\}}\n   $$\n2. \u003cmark\u003e**Local Markov Property**\u003c/mark\u003e  \n   í•œ Nodeì— ì¸ì ‘í•œ ëª¨ë“  Node(Neighbors)ê°€ ì£¼ì–´ì§ˆ ë•Œ, í•´ë‹¹ NodeëŠ” ë‹¤ë¥¸ ëª¨ë“  Nodeì™€ conditionally independentí•˜ë‹¤.  \n   (ì•„ë˜ì—ì„œ $\\mathcal{N}_{i}$ëŠ” Node iì™€ ì¸ì ‘í•œ ëª¨ë“  Nodeë¥¼ ì˜ë¯¸í•œë‹¤.)\n   $$\n   X_{i} \\perp\\!\\!\\!\\!\\perp X_{S\\backslash \\mathcal{N}_{i}} | X_{\\mathcal{N}_{i}}\n   $$\n3. \u003cmark\u003e**Global Markov Property**\u003c/mark\u003e  \n   ë§Œì•½, Nodeë“¤ì˜ Subsetìœ¼ë¡œ ì´ë£¨ì–´ì§„ $A, B$ê°€ íŠ¹ì • subset $C$ê°€ ì£¼ì–´ì§ˆ ë•Œ, ì„œë¡œ conditionally independentí•˜ë‹¤ë©´, $A, B$ì— ì†í•˜ëŠ” ì–´ë–¤ subsetì´ë¼ë„ ì„œë¡œ independentí•˜ë‹¤.  \n   (subsetê°„ì˜ conditionally independentë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” íŠ¹ì • Subsetë“¤ê°„ì— ì´ì–´ì§€ëŠ” ëª¨ë“  ê²½ë¡œë¥¼ ì°¨ë‹¨í•  ìˆ˜ ìˆëŠ” subsetì´ ìˆëŠ”ì§€ë¥¼ í™•ì¸í•œë‹¤.)  \n   $$\n   \\begin{align*}\n   X_{A} \u0026\\perp\\!\\!\\!\\!\\perp X_{B} | X_{C} \\\\\n   X_{\\text{subset of }A} \u0026\\perp\\!\\!\\!\\!\\perp X_{\\text{subset of }B} | X_{C} \\\\\n   \\end{align*}\n   $$  \n   ![ml-global-markov-property](/images/ml-global-markov-property.jpg)\n\në”°ë¼ì„œ, ìš°ë¦¬ëŠ” ì´ì „ ê·¸ë¦¼ì—ì„œ Conditional Independenceë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. $X_{1}, X_{4}$ì˜ ê²½ìš° ë‹¤ë¥¸ ëª¨ë“  Random Variableê³¼ correlationì´ ì¡´ì¬í•˜ì§€ë§Œ, $X_{2}, X_{3}$ì˜ ê²½ìš° $X_{1}, X_{4}$ë§Œ ì•Œë©´ ëœë‹¤. ì¦‰, $X_{2} \\perp\\!\\!\\!\\!\\perp X_{3} | X_{1}, X_{4}$ì´ë‹¤. ë”°ë¼ì„œ, ìš°ë¦¬ëŠ” ì´ ê´€ê³„ë¥¼ í™•ë¥  ì‹ì—ì„œ ë…¹ì—¬ë‚¼ ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\nP(X_{1}, X_{2}, X_{3}, X_{4}) \u0026= P(X_{2}|X_{1},\\cancel{X_{3}},X_{4})P(X_{1}, X_{3}, X_{4}) (\\because X_{2} \\perp\\!\\!\\!\\!\\perp X_{3} | X_{1}, X_{4}) \\\\\n\u0026= P(X_{2}|X_{1},X_{4})P(X_{1}, X_{3}, X_{4})\n\\end{align*}\n$$\n\në˜í•œ, ìš°ë¦¬ëŠ” Graphë¥¼ í†µí•´ì„œ Joint Probabilityë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•  ìˆ˜ ìˆë‹¤.\n\n$$\nP(\\cap_{i=1}^{N}X_{i}) = \\frac{1}{Z} \\prod_{C \\in \\mathcal{C}} \\psi_{C}(\\cap_{X_{j}\\in C}X_{j})\n$$\n\nì‹ì´ ë‹¤ì†Œ ë‚œí•´í•˜ë‹¤. í•˜ë‚˜ í•˜ë‚˜ í•´ì„ì„ í•´ë³´ë„ë¡ í•˜ì. ë¨¼ì €, $P(\\cap_{i=1}^{N}X_{i})$ì´ë‹¤. ì´ëŠ” Joint Probabilityë¥¼ í‘œí˜„í•˜ëŠ” ë°©ë²• ì¤‘ì˜ í•˜ë‚˜ë¡œ ë‹¨ìˆœíˆ ì´ë¥¼ ì •ë¦¬í•˜ë©´, $P(\\cap_{i=1}^{N}X_{i})=P(X_{1} \\cap X_{2} \\cap \\cdots \\cap X_{N})=P(X_{1}, X_{2}, \\cdots, X_{N})$ì´ë‹¤. ë‹¤ìŒì€ $C$ì™€ $\\mathcal{C}$ì´ë‹¤. ë‘˜ ë‹¤ ì•„ë§ˆ ì§‘í•©ì¼ ê²ƒì´ë¼ëŠ” ê²ƒì€ $\\in$ ê¸°í˜¸ ë•ë¶„ì— ì•Œ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ê·¸ë ‡ë‹¤ë©´, ì–´ë–¤ ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ” ì§‘í•©ì¼ê¹Œ? ì´ëŠ” Random Variableë“¤ë¡œ ì´ë£¨ì–´ì§„ ë¶€ë¶„ ì§‘í•©ì´ë‹¤. ì´ë¥¼ \u003cmark\u003e**Clique($C$)**\u003c/mark\u003eë¼ê³  í•œë‹¤. CliqueëŠ” Graphì—ì„œ Nodeë“¤ì˜ ë¶€ë¶„ ì§‘í•©ìœ¼ë¡œ, Graphì—ì„œ **Fully Connected Node**ì˜ ì§‘í•©ì„ ì˜ë¯¸í•œë‹¤. ì´ê²ƒì´ ê°€ì§€ëŠ” ì˜ë¯¸ëŠ” ì‚¬ì‹¤ìƒ í•˜ë‚˜ì˜ Nodeë¡œ í•©ì¹  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.(ì´ë¥¼ Graph ìƒì—ì„œì˜ ì¸ìˆ˜ë¶„í•´(**factorization**)ë¼ê³ ë„ í•œë‹¤.) Cliqueì— ì†í•˜ëŠ” Nodeë¼ë¦¬ëŠ” ì„œë¡œ ì™„ë²½í•˜ê²Œ ì—°ê²°ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì´ ì¤‘ì— í•˜ë‚˜ì˜ Nodeë¼ë„ ë‹¤ë¥¸ Nodeì™€ ì—°ê²°ì„ ê°€ì§„ë‹¤ë©´, ì´ì— ì†í•˜ëŠ” ëª¨ë“  Nodeê°€ ì´ ê´€ê³„ë¡œ ì—°ê²°ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ì¶”ê°€ì ìœ¼ë¡œ Cliqueë“¤ ì¤‘ì—ì„œ ë‹¤ë¥¸ Cliqueì— ì†í•˜ì§€ ì•ŠëŠ” Cliqueë“¤ì„ \u003cmark\u003e**Maximal Clique($\\mathcal{C}$)**\u003c/mark\u003eë¼ê³  í•œë‹¤. ì•„ë˜ ê·¸ë¦¼ì—ì„œëŠ” Maximal Cliqueë¥¼ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œê¸°í•œ ê²ƒì´ë‹¤.\n\n![ml-max-clique](/images/ml-max-clique.jpg)\n\në§ˆì§€ë§‰ìœ¼ë¡œ $\\psi$ì´ë‹¤. ì´ëŠ” \u003cmark\u003e**Clique Potential Function**\u003c/mark\u003eë¡œ, ê° Cliqueì˜ Node(Random Variable)ë¥¼ parameterë¡œ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ë¡œ í™•ë¥ ê³¼ ë¹„ìŠ·í•œ ì„±ì§ˆì„ ê°€ì§€ì§€ë§Œ í™•ë¥ ì²˜ëŸ¼ í•©ì´ 1ì´ ì•„ë‹ ìˆ˜ë„ ìˆê³ , ê°’ ìì²´ê°€ ìŒìˆ˜ì¼ ìˆ˜ë„ ìˆë‹¤. ì¦‰, ì´ë¥¼ êµ¬í•  ë•Œì—ëŠ” ê° Random Variableì˜ ê²½ìš°ì˜ ìˆ˜ì™€ í•´ë‹¹ ê²½ìš°ì˜ ìƒëŒ€ì  í™•ë¥ ë¡œ ì´ë£¨ì–´ì§„ tableì„ ì‘ì„±í•˜ê³ , ì´ë¥¼ í‘œí˜„í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¥¼ ì°¾ì•„ë‚¸ ê²ƒì´ $\\psi$ì´ë‹¤. ëŒ€ê²Œì˜ ê²½ìš° $\\psi$ëŠ” í•´ë‹¹ Parameterë¡œ ì´ë£¨ì–´ì§„ Condition Probability ë˜ëŠ” Joint Probabilityê°€ ë˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤. í•˜ì§€ë§Œ, ê·¸ë ‡ì§€ ì•Šì€ ê²½ìš°ì—ë„ $\\psi$ë¡œ í‘œí˜„ì´ ê°€ëŠ¥í•˜ë‹¤.(ì´ì— ëŒ€í•œ ì—„ë°€í•œ ì¦ëª…ì€ ì—¬ê¸°ì„œ ë‹¤ë£¨ì§€ ì•Šì„ ë¿ë§Œ ì•„ë‹ˆë¼ ì¤‘ìš”í•˜ì§€ ì•Šë‹¤.) ì—¬ê¸°ì„œ \u003cmark\u003e$Z$\u003c/mark\u003eì˜ ì˜ë¯¸ë¥¼ ë§ˆì§€ë§‰ìœ¼ë¡œ ì§šì–´ë³´ìë©´, ë‹¨ìˆœí•œ normalizationì´ë‹¤. $\\psi$ê°€ ìš´ì¢‹ê²Œë„ Joint Probability, Conditional Probabilityë¡œ ì‰½ê²Œ êµ¬í•´ì§„ë‹¤ë©´ $Z=1$ì´ë‹¤. í•˜ì§€ë§Œ, ê·¸ë ‡ì§€ ì•Šì„ ê²½ìš°ì—ëŠ” ì´ë“¤ì˜ í•©ì´ 1ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— Normalizationì´ í•„ìš”í•œ ê²ƒì´ë‹¤.\n\n$$\n\\begin{align*}\nZ \u0026= \\sum_{X_{1}}\\sum_{X_{2}} \\cdots \\sum_{X_{N}}{\\prod_{C \\in \\mathcal{C}} \\psi_{C}(\\cap_{X_{j}\\in C}X_{j})} \\\\\n\u0026= \\sum_{X_{1}, X_{2}, \\cdots, X_{N}}{\\prod_{C \\in \\mathcal{C}} \\psi_{C}(\\cap_{X_{j}\\in C}X_{j})}\n\\end{align*}\n$$\n\nê²°ë¡ ì ìœ¼ë¡œ ì˜ë¯¸ë¥¼ ë”°ì§€ìë©´, ìœ„ì—ì„œ êµ¬í•œ **Maximal Clique**ì— íŠ¹ì • í•¨ìˆ˜ë¥¼ ì·¨í•œ $\\psi$ê°€ ì¸ìˆ˜ë¶„í•´(**factorization**)ì—ì„œ í•˜ë‚˜ì˜ ì¸ì(**factor**)ê°€ ë˜ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ, ì´ë¥¼ **factor function**ì´ë¼ê³ ë„ ë¶€ë¥¸ë‹¤.\n\nì, ë§ˆì§€ë§‰ìœ¼ë¡œ ìš°ë¦¬ê°€ 4ê°œì˜ Random Variable 4ê°œ($A, B, C, D$)ê°€ ìˆì„ ë•Œ, Graphë¡œ ê·¸ë¦´ ìˆ˜ ìˆëŠ” í˜•íƒœë¥¼ ë„¤ ê°œ ì •ë„ ê°€ì •í•˜ì—¬ ì˜ˆì‹œë“¤ì„ ì‚´í´ë³¼ ê²ƒì´ë‹¤.\n\n![ml-undirected-graph-2](/images/ml-undirected-graph-2.jpg)\n\n1. $A, B, C, D$ê°€ ì„ í˜•ìœ¼ë¡œ ì´ë£¨ì–´ì§„ë‹¤.  \n   ì—¬ê¸°ì„œëŠ” **Maximal Clique**ê°€ 3ê°œì´ë‹¤($\\{\\{A, B\\}, \\{ B, C\\}, \\{ C, D\\}\\}$). ë”°ë¼ì„œ, ì´ë¥¼ í†µí•´ì„œ Joint Probabilityë¥¼ ì¶”ì •í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.  \n   $$\n   P(A, B, C, D) = \\frac{1}{Z} \\times \\psi_{1}(A, B) \\times \\psi_{2}(B, C) \\times \\psi_{3}(C, D)\n   $$  \n   ì—¬ê¸°ì„œ ì§ì ‘ì ìœ¼ë¡œ í•œ ë²ˆ $P(A, B, C, D)$ë¥¼ ì¶”ì •í•´ë³´ì.  \n   $$\n   \\begin{align*}\n   P(A, B, C, D) \u0026= P(A| B, C, D) \\times P(B | C, D) \\times P(C, D) \\\\\n   \u0026= P(A|B) \\times P(B|C) \\times P(C, D)\n   \\end{align*}\n   $$  \n   ì¦‰, ì´ë ‡ê²Œ ì¼ë ¬ë¡œ ëœ Graphì—ì„œëŠ” ë§ˆì§€ë§‰ $\\psi$ë¥¼ ì œì™¸í•˜ê³ ëŠ” ëª¨ë‘ Conditional Probabilityì´ê³ , ë§ˆì§€ë§‰ $\\psi$ëŠ” Joint Probabilityì´ë‹¤. ê·¸ë¦¬ê³ , $Z$ëŠ” 1ì´ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.\n2. $A, B, C, D$ê°€ ëª¨ë‘ ì™„ë²½í•˜ê²Œ ì—°ê²°ë˜ì–´ ìˆë‹¤.  \n   ì´ ê²½ìš°ì—ëŠ”  **Maximal Clique**ê°€ 1ê°œì´ë‹¤($\\{\\{A, B, C, D\\}\\}$). ë”°ë¼ì„œ, Joint Probabilityë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì¶”ì •í•  ìˆ˜ ìˆë‹¤.  \n   $$\n   P(A, B, C, D) = \\frac{1}{Z} \\times \\psi(A, B, C, D)\n   $$  \n   ê²°ë¡ ì ìœ¼ë¡œ Cliqueê°€ í•˜ë‚˜ê¸° ë•Œë¬¸ì— ì¤„ì¼ ìˆ˜ ìˆëŠ” ë³€ìˆ˜ê°€ ì—†ë‹¤. ì¦‰, $\\psi$ê°€ Joint Probabilityì´ê³ , $Z$ëŠ” 1ì´ë‹¤.\n3. **Maximal Clique**ê°€ 2ê°œì´ë‹¤($\\{\\{A, B, D\\}\\, \\{A, C, D\\}\\}$). ë”°ë¼ì„œ, ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬ëœë‹¤.  \n   $$\n   \\begin{align*}\n   P(A, B, C, D) \u0026= P(B|A, C, D) \\times P(A, C, D) \\\\\n   \u0026= P(B|A,D) \\times P(A, C, D) \\\\\n   \u0026= \\frac{1}{Z} \\times \\psi_{1}(A, B, D) \\times \\psi_{2}(A, C, D) \\\\\n   \\end{align*}\n   $$\n4. **Maximal Clique**ê°€ 4ê°œì´ë‹¤($\\{\\{A, B\\}, \\{ A, C\\}, \\{ B, D\\}, \\{ C, D\\}\\ \\}$).  \n   $$\n   \\begin{align*}\n   P(A, B, C, D) \u0026= P(A|B, C, D) \\times P(B|C, D) \\times P(C, D) \\\\\n   \u0026= P(A|B, C) \\times P(B|D) \\times P(C, D) \\\\\n   \u0026= \\frac{P(A, B, C)}{P(B, C)} \\times P(B|D) \\times P(C, D) \\\\\n   \u0026= \\frac{P(B, C| A)}{P(A)P(B, C)} \\times P(B|D) \\times P(C, D) \\\\\n   \u0026= \\frac{P(B|A)P(C|A)}{P(A)P(B, C)} \\times P(B|D) \\times P(C, D) \\\\\n   \u0026= \\frac{1}{P(B,C)} \\times P(A, B) \\times P(C|A) \\times P(B|D) \\times P(C, D) \\\\\n   \u0026\\neq \\frac{1}{Z} \\times \\psi_{1}(A, B) \\times \\psi_{2}(A, C) \\times \\psi_{3}(B, D) \\times \\psi_{4}(C, D) \\\\\n   \\end{align*}\n   $$  \n   ì´ê²ƒì´ ë°”ë¡œ $\\psi$ë¥¼ í™•ë¥  í•¨ìˆ˜ë¼ê³  ë¶€ë¥´ì§€ ì•ŠëŠ” ì´ìœ ì´ë‹¤.  \n   ìš°ë¦¬ê°€ $\\psi$ë¥¼ í™•ë¥  í•¨ìˆ˜ í˜•íƒœë¡œ í‘œí˜„í•˜ê¸° ìœ„í•´ì„œëŠ” **Chordal graph**(4ê°œ ì´ìƒì˜ Nodeë¡œ ì´ë£¨ì–´ì§„ Cycleì—ì„œëŠ” ì¤‘ê°„ì— ë°˜ë“œì‹œ Cycleì„ ì´ë£¨ëŠ” Edgeê°€ ì•„ë‹Œ Edgeê°€ ì¡´ì¬í•˜ëŠ” Graph) í˜•íƒœë¥¼ ê°€ì ¸ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. $\\psi$ê°€ í™•ë¥  í•¨ìˆ˜ë¡œ í‘œí˜„ë˜ì§€ ì•ŠëŠ”ë‹¤ê³  ìš°ë¦¬ê°€ í•˜ê³ ì í•˜ëŠ” ì¼ì— ì˜í–¥ì„ ì£¼ì§€ëŠ” ì•Šìœ¼ë‹ˆ ê·¸ëŸ°ê°€ë³´ë‹¤ í•˜ê³  ë„˜ì–´ê°€ë„ ë¬´ë°©í•˜ë‹¤.\n\nì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” **factorization**ì´ë¼ëŠ” ê°œë…ì„ ìµí˜”ê³ , ì´ê²ƒì´ ê°€ëŠ¥í•˜ê¸° ìœ„í•´ì„œëŠ” Chordal graphê°€ ì£¼ì–´ì§„ ìƒí™©ì—ì„œ Markov Propertyë¥¼ ë§Œì¡±í•´ì•¼ í•¨ì„ í™•ì¸í–ˆë‹¤. ê·¸ë¦¬ê³ , ìš°ë¦¬ëŠ” ì´ëŸ¬í•œ **factorization** í˜•íƒœë¥¼ ì¢€ ë” ëª…í™•í•˜ê²Œ ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œ í‘œí˜„í•˜ê³ , ì´ë¥¼ \u003cmark\u003e**factor graph**\u003c/mark\u003eë¼ê³  ì •ì˜í•œë‹¤. ë”°ë¼ì„œ, ê° **factor**(ì¸ìˆ˜)ëŠ” **Maximal Clique** ë‹¨ìœ„ë¡œ ìƒì„±ëœë‹¤.\n\n![ml-factor-graph-1](/images/ml-factor-graph-1.jpg)\n\n### Bayesian Network(Directed Graphical Model, Causality)\n\n**Bayesian Network**ë¼ê³  ë¶ˆë¦¬ë©°, **Causality**ë¥¼ í‘œí˜„í•œ Graphì´ë‹¤. ê° NodeëŠ” Random Variableì„ ì˜ë¯¸í•˜ë©°, EdgeëŠ” Causality(ì›ì¸($C$) -\u003e ê²°ê³¼($R$))ë¥¼ ì˜ë¯¸í•œë‹¤. ê·¸ë ‡ê¸°ì— êµ‰ì¥íˆ ëª…í™•í•˜ê²Œ í‘œí˜„ì´ ë  ìˆ˜ ìˆë‹¤. ì™œëƒí•˜ë©´, $P(R, C) = P(C|R)P(R)$ì„ì„ ëª…ë°±í•˜ê²Œ ë“œëŸ¬ë‚¸ë‹¤. ê·¸ë ‡ê¸°ì— ìš°ë¦¬ëŠ” í•´ë‹¹ Graphê°€ ì£¼ì–´ì§€ëŠ” ìˆœê°„ Joint Probabilityë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìœ ì¶”í•  ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.\n\n![ml-bayesian-network](/images/ml-bayesian-network.jpg)\n\nì¦‰, ì´ê²ƒì„ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n$$\nP(\\cap_{i=1}^{N}X_{i}) = \\prod_{i \\in \\{1, 2, \\cdots, N\\}} P(X_{i}| \\cap_{j \\in \\text{Parents}(X_{i})} X_{j})\n$$\n\nì´ëŸ¬í•œ ì  ë•Œë¬¸ì— Bayesian Networkì—ì„œëŠ” Cycleì´ ì¡´ì¬í•  ìˆ˜ ì—†ë‹¤. ì™œëƒí•˜ë©´, Cycleì´ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì€ ê° Random Varaibleì´ ì„œë¡œ ì›ì¸ê³¼ ê²°ê³¼ê°€ ë˜ëŠ” ê²ƒì´ ë•Œë¬¸ì— ì‚¬ì‹¤ìƒ í•˜ë‚˜ì˜ ì‚¬ê±´ì´ë¼ëŠ” ì˜ë¯¸ë¥¼ ë‚´í¬í•˜ëŠ” ê²ƒì´ë‹¤. ê·¸ë ‡ê¸°ì— ì´ëŠ” ì‚¬ì‹¤ìƒ ì¡´ì¬í•  ìˆ˜ ì—†ë‹¤.\n\nì—¬ê¸°ì„œë„ ë§ˆì°¬ê°€ì§€ë¡œ Conditional Independenceë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤. ë¿ë§Œ ì•„ë‹ˆë¼ Marginal Independenceì— ëŒ€í•œ íŒíŠ¸ë„ ì–»ì„ ìˆ˜ ìˆë‹¤. ì´ë•Œ ìš°ë¦¬ëŠ” \u003cmark\u003e**D-Seperation**\u003c/mark\u003eì´ë¼ëŠ” ë°©ë²•ì„ í™œìš©í•œë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” ìì‹ ê³¼ ì£¼ë³€ 2ê°œì˜ Nodeê°€ ì´ë£° ìˆ˜ ìˆëŠ” ê´€ê³„ 3ê°€ì§€ë¥¼ ì •ì˜í•´ì•¼ í•œë‹¤.\n\n![ml-bayesian-network-2](/images/ml-bayesian-network-2.jpg)\n\n1. **head-to-tail**  \n   ì´ ê²½ìš°ì—ëŠ” $X \\rightarrow Y \\rightarrow Z$ì˜ ê´€ê³„ë¥¼ ì˜ë¯¸í•œë‹¤. ë”°ë¼ì„œ, $X$ì™€ $Z$ëŠ” $Y$ê°€ ì£¼ì–´ì§ˆ ë•Œ, ì„œë¡œ Independentí•˜ë‹¤.  \n   $$\n   \\begin{align*}\n   P(X, Z | Y) \u0026= \\frac{P(X,Y,Z)}{P(Y)}\\\\\n   \u0026= \\frac{P(X)P(Y|X)P(Z|Y)}{P(Y)}\\\\\n   \u0026= \\frac{P(X, Y)}{P(Y)} \\times P(Z|Y) \\\\\n   \u0026= P(X | Y)P(Z | Y)\n   \\end{align*}\n   $$\n2. **tail-to-tail**  \n   ì´ ê²½ìš°ì—ëŠ” $X \\leftarrow Y \\rightarrow Z$ì˜ ê´€ê³„ë¥¼ ì˜ë¯¸í•œë‹¤. ë”°ë¼ì„œ, $X$ì™€ $Z$ëŠ” $Y$ê°€ ì£¼ì–´ì§ˆ ë•Œ, ì„œë¡œ Independentí•˜ë‹¤.  \n   $$\n   \\begin{align*}\n   P(X, Z | Y) \u0026= \\frac{P(X, Y, Z)}{P(Y)} \\\\\n   \u0026= \\frac{P(X|Y)P(Y)P(Z|Y)}{P(Y)} \\\\\n   \u0026= P(X | Y)P(Z | Y)\n   \\end{align*}\n   $$\n3. **head-to-head**  \n   ì´ ê²½ìš°ì—ëŠ” $X \\rightarrow Y \\leftarrow Z$ì˜ ê´€ê³„ë¥¼ ì˜ë¯¸í•œë‹¤. ë”°ë¼ì„œ, $X$ì™€ $Z$ëŠ” ì„œë¡œ Independentí•˜ë‹¤.  \n   ì¦‰, Conditional Independenceê°€ ì•„ë‹ˆë¼ Marginal Independenceì´ë‹¤.  \n   $$\n   \\begin{align*}\n   P(X, Z) \u0026= \\sum_{Y} P(X, Y, Z) \\\\\n   \u0026= \\sum_{Y} P(X)P(Y|X,Z)P(Z) \\\\\n   \u0026= P(X)P(Z)\\sum_{Y} P(Y|X,Z) \\\\\n   \u0026= P(X)P(Z)\n   \\end{align*}\n   $$\n\nì´ ê´€ê³„ì—ì„œ ì¤‘ìš”í•œ ê²ƒì€ $X,Z$ê°„ edgeê°€ ì¡´ì¬í•´ì„œëŠ” ì•ˆëœë‹¤ëŠ” ì ì´ë‹¤. ìœ„ì˜ ê´€ê³„ë¥¼ í™œìš©í•˜ë©´, ì¸ì ‘í•œ ê´€ê³„ì—ì„œì˜ Conditional IndependenceëŠ” íŒë³„ì´ ê°€ëŠ¥í•˜ë‹¤.í•˜ì§€ë§Œ, \u003cmark\u003e**D-Seperation**\u003c/mark\u003eì„ í†µí•´ì„œ ì´ë¥¼ ë” ë„“ì€ ë²”ìœ„ë¡œ í™•ì¥í•  ìˆ˜ ìˆë‹¤. ì„¸ Nodeì˜ ì§‘í•© $A, B, C$ê°€ ì£¼ì–´ì§ˆ ë•Œ, $A \\perp\\!\\!\\!\\!\\perp B | C$ì´ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í•œë‹¤.\n\n1. Aì—ì„œ Bë¡œ ê°€ëŠ” ê²½ë¡œê°€ í•˜ë‚˜ ì´ìƒ ì¡´ì¬í•œë‹¤.(ì—¬ê¸°ì„œ ê²½ë¡œëŠ” ë°©í–¥ì„ ì‹ ê²½ì“°ì§€ ì•Šê³  ì—°ê²° ì—¬ë¶€ì— ë”°ë¼ ê²°ì •í•œë‹¤.)\n2. ëª¨ë“  ê²½ë¡œì— ëŒ€í•´ì„œ, Cì— ì†í•˜ëŠ” Nodeê°€ ì ì–´ë„ í•˜ë‚˜ head-to-tail ë˜ëŠ” tail-to-tail ê´€ê³„ë¥¼ ì¤‘ê³„í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.\n3. ëª¨ë“  ê²½ë¡œì— ëŒ€í•´ì„œ, Cì— ì†í•˜ëŠ” NodeëŠ” head-to-head ê´€ê³„ë¥¼ ì¤‘ê³„í•˜ë©´ ì•ˆë˜ë©°, head-to-head ê´€ê³„ë¥¼ ì¤‘ê³„í•˜ëŠ” Nodeì˜ ìì†ì´ì—¬ë„ ì•ˆëœë‹¤.\n\nì¦‰, $A, B, C$ê°€ ì´ëŸ¬í•œ ì¡°ê±´ì„ ëª¨ë‘ ë§Œì¡±í•  ë•Œ, ìš°ë¦¬ëŠ” $C$ê°€ $A, B$ë¥¼ Blockí–ˆë‹¤ê³  í•˜ë©°, $A \\perp\\!\\!\\!\\!\\perp B | C$ì´ë‹¤.\n\nì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ì™€ ê°™ì€ ë‘ ê²½ìš°ë¥¼ ì˜ˆë¥¼ ë“¤ì–´ë³¼ ìˆ˜ ìˆë‹¤.\n\n![ml-d-seperation](/images/ml-d-seperation.jpg)\n\nì™¼ìª½ì˜ ê²½ìš° Cì˜ parentê°€ Aì—ì„œ Bë¡œ ê°€ëŠ” ê²½ë¡œì—ì„œ head-to-headë¥¼ ì¤‘ê³„í•˜ê³  ìˆë‹¤. ë”°ë¼ì„œ, Aì™€ BëŠ” Conditionally Independenceë¥¼ ë§Œì¡±í•˜ì§€ ì•ŠëŠ”ë‹¤. ë°˜ë©´, ì˜¤ë¥¸ìª½ì˜ ê²½ìš° Cê°€ Aì—ì„œ Bë¡œ ê°€ëŠ” ê²½ë¡œì—ì„œ head-to-tail ê´€ê³„ë¥¼ ì¤‘ê³„í•˜ê³  ìˆìœ¼ë¯€ë¡œ, Aì™€ BëŠ” Conditionally Independenceë¥¼ ë§Œì¡±í•œë‹¤. ì—¬ê¸°ì„œ ì¬ë°ŒëŠ” ì ì€ Aì™€ BëŠ” ë‘ ê²½ìš° ëª¨ë‘ Marginal Independenceë¥¼ ë§Œì¡±í•œë‹¤ëŠ” ì ì´ë‹¤. ì™œëƒí•˜ë©´, Aì—ì„œ Bë¡œ ê°€ëŠ” ê²½ë¡œê°€ ìˆœë°©í–¥ë§Œìœ¼ë¡œëŠ” ì´ë£¨ì–´ì§€ì§€ ì•Šê¸° ë•Œë¬¸ì´ë‹¤.\n\në§ˆì§€ë§‰ìœ¼ë¡œ, Bayesian Networkë„ **factorization**ì´ ê°€ëŠ¥í•˜ë‹¤ A, Bì˜ **Causality**ê°€ $P(A|B)P(B)$ë¥¼ ì˜ë¯¸í•œë‹¤ëŠ” ì ì„ í™œìš©í•´ì„œ ìš°ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¡œ ì •ì˜í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤.\nì¦‰, ì´ˆê¸° ì‹œì‘ ì ì€ ìì‹ ë§Œì„ ê°€ì§€ëŠ” factorë¥¼ ê°€ì§€ê³ , head-to-head ê´€ê³„ëŠ” í•˜ë‚˜ë¡œ í†µì¼í•˜ë©°, ë‚˜ë¨¸ì§€ ê´€ê³„(head-to-head, ë“±)ëŠ” ë³„ë„ë¡œ factorë¥¼ ë¶„ë¦¬í•œë‹¤. ì¦‰, ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¥¼ ê°€ì§„ë‹¤.\n\n![ml-factor-graph-2](/images/ml-factor-graph-2.jpg)\n\n```plaintext\n ğŸ¤” Markov Blankets\n\n Markov Blanketì€ íŠ¹ì • Nodeì— ëŒ€í•œ ì •ë³´(ê´€ê³„)ê°€ ìˆëŠ” ëª¨ë“  Nodeë¥¼ ì˜ë¯¸í•œë‹¤. \n ì¦‰, íŠ¹ì • Random Variableì˜ í™•ë¥ ì´ ê¶ê¸ˆí•˜ë‹¤ë©´, ì´ Markov Blanketë§Œ ê°€ì§€ë©´ ëœë‹¤. \n ê·¸ ì¤‘ì—ì„œë„ ê°€ì¥ ì‘ì€ í¬ê¸°ë¡œ ëª¨ë“  í•„ìš”í•œ ì •ë³´ë¥¼ ë‹´ì€ subsetì„ Markov Boundaryë¼ê³  í•œë‹¤. \n Markov BoundaryëŠ” Markov Random Fieldì—ì„œëŠ” Neighborì´ê³ ,\n Bayesian Networkì—ì„œëŠ” Parent, Child, Co-Parentì´ë‹¤.\n```\n\n![ml-markov-boundary](/images/ml-markov-boundary.jpg)\n\n### Factor Graph\n\nì• ì„œ ë³¸ ë‘ ê°€ì§€ Graph í‘œí˜„ ë°©ë²•ì€ ê° ê° ì¥ë‹¨ì ì„ ê°€ì§€ê³  ìˆë‹¤.\n\n1. Markov Random FieldëŠ” Joint Probabilityë¥¼ Potentialì´ë¼ëŠ” ì„ì˜ì˜ ë³€ìˆ˜ë¥¼ í†µí•´ì„œ ì¶”ì •í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤. ë”°ë¼ì„œ, ëª…í™•ì„±ì´ ë–¨ì´ì§€ì§€ë§Œ, Conditional Independenceë¥¼ íŒŒì•…í•˜ëŠ” ê²ƒì€ ë” ë¶„ëª…í•˜ê³  ì‰½ë‹¤.\n2. Bayesian NetworkëŠ” Joint Probabilityë¥¼ ëª…í™•í•˜ê²Œ íŒë³„í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, Conditional Independenceë¥¼ íŒë³„í•˜ëŠ” ê²ƒì´ ë” ì–´ë µê³  ë³µì¡í•˜ë‹¤.\n\nì´ëŸ¬í•œ ì¥ë‹¨ì ì„ ëª¨ë‘ ì‚´ë¦´ ìˆ˜ ìˆëŠ” ë°©ë²•ìœ¼ë¡œ ì œì‹œëœ ê²ƒì´ Factor Graphì´ë‹¤. ìœ„ì—ì„œ ê° ê° Factor Graphë¥¼ í‘œí˜„í•˜ëŠ” ë°©ë²•ì— ëŒ€í•´ì„œëŠ” ì œì‹œí•˜ì˜€ìœ¼ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ë‹¤ë£¨ì§€ ì•ŠëŠ”ë‹¤. Factor GraphëŠ” ê·¼ë³¸ì ìœ¼ë¡œ Graphì˜ ìš”ì†Œë“¤ì„ ì¸ìˆ˜ë¶„í•´(Factorization)í•˜ì—¬ ì¸ìˆ˜(Factor)ë¡œ ë¶„ë¦¬í•´ë‚¸ ê²ƒì´ë‹¤. ê·¸ë ‡ê¸°ì— ë” ëª…í™•í•œ êµ¬ë¶„ì´ ê°€ëŠ¥í•˜ë‹¤. ê° NodeëŠ” Factorì™€ ê¸°ì¡´ Nodeì— í•´ë‹¹í•˜ëŠ” ê°’ì´ ë‘ ê°œ ë‹¤ ì¡´ì¬í•˜ê³ , FactorëŠ” ê½‰ ì°¬ ë„¤ëª¨, ê¸°ì¡´ Node(Variable)ëŠ” ë¹„ì–´ìˆëŠ” ë™ê·¸ë¼ë¯¸ë¡œ í‘œí˜„í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.\n\nê·¸ë¦¬ê³ , ì—¬ê¸°ì„œëŠ” Joint Probabilityë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•œë‹¤.\n\nVariable NodeëŠ” $\\{X_{1},X_{2}, \\cdots, X_{N}\\}$ì´ê³ , Factor Nodeê°€ $\\{f_{1},f_{2}, \\cdots, f_{M}\\}$ì¼ ë•Œ, $f_{j}$ì™€ ì´ì›ƒí•œ Variable Nodeì˜ ì§‘í•©ì„ $\\mathcal{N}_{j}$ë¼ê³  í•˜ì.\n\n$$\nP(X_{1}, X_{2}, \\cdots, X_{N}) = \\prod_{j=1}^{M}{f_{j}(\\cap_{X \\in \\mathcal{N}_{j}} X)}\n$$\n\nì´ë ‡ê²Œ í‘œí˜„í•˜ëŠ” ê²ƒì€ í™•ì‹¤íˆ Markov Random Fieldì—ì„œëŠ” ëª…í™•í•˜ë‹¤. í•˜ì§€ë§Œ, Bayesian Networkì—ì„œëŠ” í‘œí˜„í•  ìˆ˜ ìˆëŠ” ì •ë³´ë¥¼ ì–´ëŠì •ë„ ìƒì—ˆë‹¤ê³  ë³¼ ìˆ˜ë„ ìˆë‹¤. ì–´ì°¨í”¼ Conditional Probabilityì¸ë°, ë‹¤ë¥´ê²Œ í‘œí˜„í•œ ê²ƒì´ê¸° ë•Œë¬¸ì´ë‹¤. í•˜ì§€ë§Œ, ì´ë¥¼ ì´ìš©í•˜ê²Œ ë˜ë©´ ê¸°ì¡´ì— ë¬¸ì œì˜€ë˜ Conditional Independenceë¥¼ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤. ì™œëƒí•˜ë©´ Factor Graphì—ì„œëŠ” Conditional Independenceë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ì„œ í•´ë‹¹ ì§‘í•©ìœ¼ë¡œ ì´ì–´ì§€ëŠ” ëª¨ë“  ê²½ë¡œì—ì„œ ì¤‘ê°„ì— í•˜ë‚˜ë¼ë„ Variable Nodeê°€ ê»´ìˆëŠ”ì§€ë§Œ í™•ì¸í•´ë„ ì¶©ë¶„í•˜ë‹¤.\n\n![ml-factor-graph-3](/images/ml-factor-graph-3.jpg)\n\në”°ë¼ì„œ, ì•ìœ¼ë¡œì˜ ê³¼ì •ì—ì„œëŠ” Factor Graphë¥¼ Mainìœ¼ë¡œ í•˜ì—¬ ì„¤ëª…ì„ ì§„í–‰í•˜ë„ë¡ í•˜ê² ë‹¤.\n\n## Message Passing\n\nìš°ë¦¬ëŠ” ì•ì˜ Graph í‘œí˜„ì„ í†µí•´ì„œ Featureë¥¼ Factorë¡œ ì••ì¶•í•˜ëŠ” ê³¼ì •ì„ ìµí˜”ë‹¤. ì´ ì—­ì‹œ ì—„ì²­ë‚œ ê³„ì‚° íš¨ìœ¨ì„ ê°€ì ¸ì˜¨ë‹¤. í•˜ì§€ë§Œ, ì´ë¥¼ ë” íš¨ê³¼ì ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ìˆë‹¤. ê·¸ê²ƒì€ Message Passing ë°©ë²•ì´ë‹¤. ìš°ì„  ìš°ë¦¬ê°€ í•´ê²°í•˜ê³ ìí•˜ëŠ” ë¬¸ì œë¥¼ ì •ì˜í•´ë³´ì. ìš°ë¦¬ëŠ” Joint Probability($P(X_{1}, X_{2}, \\cdots, X_{N})$)ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ë‹¤ìŒ ê°’ì„ êµ¬í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆë‹¤.\n\n1. \u003cmark\u003e**Marginalization**\u003c/mark\u003e  \n   Marginal ProbabilityëŠ” Joint Probabilityì—ì„œ êµ¬í•˜ê³ ì í•˜ëŠ” Random Variableì„ ì œì™¸í•œ ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ ë”í•œ ê²ƒì´ë‹¤.\n   $$\n   \\begin{align*}\n   P(X_{i}) \u0026= \\sum_{X_{j}}P(X_{i}, X_{j}) \\\\\n   \u0026= \\sum_{X_{j}, X_{k}}P(X_{i}, X_{j}, X_{k}) \\\\\n   \u0026= \\cdots \\\\\n   \u0026= \\sum_{X_{-i}}P(X_{1}, X_{2}, \\cdots, X_{N})\n   \\end{align*}\n   $$  \n   ì¦‰, ì´ë¥¼ ì¼ë°˜ì ì¸ ë°©ë²•ìœ¼ë¡œ í’€ê³ ìí•˜ë©´ Random Variable($X_{i}$)ì´ ê° ê° $\\mathbb{R}^{L}$ë¡œ ì •ì˜ëœë‹¤ê³  í•  ë•Œ, $L^{N-1}$ë²ˆì˜ í•©ì—°ì‚°ì´ í•„ìš”í•˜ë‹¤.\n2. \u003cmark\u003e**Maximization**\u003c/mark\u003e  \n   Joint Probabilityì˜ ìµœëŒ“ê°’ì„ ê°–ê²Œ í•˜ëŠ” ê²½ìš°ì˜ ìˆ˜($\\hat{X}$)ë¥¼ êµ¬í•˜ê³ ì í•œë‹¤ë©´ ë‹¤ìŒì„ êµ¬í•´ì•¼ í•œë‹¤.  \n   $$\n   \\hat{X} = \\argmax_{X_{1}, X_{2}, \\cdots, X_{N}} P(X_{1}, X_{2}, \\cdots, X_{N})\n   $$  \n   ì´ ë˜í•œ ë¬´ì‹í•˜ê²Œ í’€ê³ ìí•˜ë©´, $L^{N-1}$ë²ˆì˜ max ì—°ì‚°ì´ í•„ìš”í•˜ë‹¤.\n\nê·¸ë ‡ë‹¤ë©´, ì´ë¥¼ í•œ ë²ˆ ê°€ì¥ ê°„ë‹¨í•œ í˜•íƒœì¸ ì¼ìí˜• Factor Graphë¡œ í‘œí˜„í•´ë³´ì.\n\n![ml-bp-1](/images/ml-bp-1.jpg)\n\nì—¬ê¸°ì„œ $P(X_{2})$ë¥¼ ì•Œê³  ì‹¶ë‹¤ê³  í•´ë³´ì. ê·¸ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì‹ì´ ì •ë¦¬ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\nP(X_{2}) \u0026= \\sum_{X_{1}}P(X_{1},X_{2}) \\\\\n\u0026= \\sum_{X_{1}, X_{3}, X_{4}, X_{5}}P(X_{1}, X_{2}, X_{3}, X_{4}, X_{5}) \\\\\n\u0026= \\sum_{X_{1}}\\sum_{X_{3}}\\sum_{X_{4}}\\sum_{X_{5}}P(X_{1}, X_{2}, X_{3}, X_{4}, X_{5}) \\\\\n\u0026= \\sum_{X_{1}}\\sum_{X_{3}}\\sum_{X_{4}}\\sum_{X_{5}}f_{a}(X_{1}, X_{2})f_{b}(X_{2}, X_{3})f_{c}(X_{3}, X_{4})f_{d}(X_{4}, X_{5}) \\\\\n\u0026= (\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))(\\sum_{X_{3}}\\sum_{X_{4}}\\sum_{X_{5}}f_{b}(X_{2}, X_{3})f_{c}(X_{3}, X_{4})f_{d}(X_{4}, X_{5})) \\\\\n\u0026= (\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))(\\sum_{X_{3}}\\sum_{X_{4}}f_{b}(X_{2}, X_{3})f_{c}(X_{3}, X_{4})\\sum_{X_{5}}f_{d}(X_{4}, X_{5})) \\\\\n\u0026= (\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))(\\sum_{X_{3}}f_{b}(X_{2}, X_{3})\\sum_{X_{4}}f_{c}(X_{3}, X_{4})\\sum_{X_{5}}f_{d}(X_{4}, X_{5}))\n\\end{align*}\n$$\n\nì´ê²ƒì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ” ë¬´ì—‡ì¼ê¹Œ? ì´ëŠ” ë‹¨ìˆœí•˜ê²Œ ìˆœì„œë¥¼ ë°”ê¾¸ì–´ ì¬ì¡°í•©í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ Computingì„ ì¤„ì¼ ìˆ˜ ìˆìŒì„ ë³´ì—¬ì¤¬ë‹¤. ë¨¼ì €, ì•ì˜ $\\sum$ì—°ì‚°ë§Œ ë‹¨ë…ìœ¼ë¡œ í•  ë•Œ, $L$ë²ˆì˜ ì—°ì‚°ì´ í•„ìš”í•˜ê³ , ë’¤ì— ì—°ì†í•´ì„œ ë‚˜ì˜¤ëŠ” 3ë²ˆì˜ $\\sum$ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œëŠ” ê²°êµ­ $L^{3}$ì˜ ì—°ì‚°ì´ í•„ìš”í•˜ë‹¤. ì¦‰, $L + L^{3}$ì˜ í•©ì—°ì‚°ìœ¼ë¡œ marginalization ê²°ê³¼ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ë ‡ê¸°ì— ë” íš¨ìœ¨ì ì¸ ì—°ì‚°ì´ ê°€ëŠ¥í•œ ê²ƒì´ë‹¤. ì´ëŠ” íŠ¹íˆ Graphì˜ ì¤‘ì•™ì— ìˆëŠ” ê°’ì„ êµ¬í•  ë•Œ ë” ë„ë“œë¼ì§€ê²Œ ë‚˜íƒ€ë‚œë‹¤. ì „ì²´ marginalization ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n$$\n\\begin{align*}\nP(X_{1}) \u0026= \\sum_{X_{2}}f_{a}(X_{1}, X_{2})\\sum_{X_{3}}f_{b}(X_{2}, X_{3})\\sum_{X_{4}}f_{c}(X_{3}, X_{4})\\sum_{X_{5}}f_{d}(X_{4}, X_{5}) \\rightarrow L^{4} \\\\\nP(X_{2}) \u0026= (\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))(\\sum_{X_{3}}f_{b}(X_{2}, X_{3})\\sum_{X_{4}}f_{c}(X_{3}, X_{4})\\sum_{X_{5}}f_{d}(X_{4}, X_{5})) \\rightarrow L^{3} + L \\\\\nP(X_{3}) \u0026= (\\sum_{X_{2}}f_{b}(X_{2}, X_{3})\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))(\\sum_{X_{4}}f_{c}(X_{3}, X_{4})\\sum_{X_{5}}f_{d}(X_{4}, X_{5})) \\rightarrow 2L^{2} \\\\\nP(X_{4}) \u0026= (\\sum_{X_{3}}f_{c}(X_{3}, X_{4})\\sum_{X_{2}}f_{b}(X_{2}, X_{3})\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))(\\sum_{X_{5}}f_{d}(X_{4}, X_{5})) \\rightarrow L^{3} + L \\\\\nP(X_{5}) \u0026= \\sum_{X_{4}}f_{d}(X_{4}, X_{5})\\sum_{X_{3}}f_{c}(X_{3}, X_{4})\\sum_{X_{2}}f_{b}(X_{2}, X_{3})\\sum_{X_{1}}f_{a}(X_{1}, X_{2}) \\rightarrow L^{4}\n\\end{align*}\n$$\n\nì´ê²ƒì´ ëì´ ì•„ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ì¤‘ë³µëœ ì—°ì‚°ì„ ë³„ë„ë¡œ ì €ì¥í•´ë‘ì–´ì„œ ë” ë¹ ë¥¸ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ì€ ê³¼ì •ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\nP(X_{2}) \u0026= \\underbrace{(\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))}_{\\red{\\mu_{a\\rightarrow2}(X_{2})}}(\\sum_{X_{3}}f_{b}(X_{2}, X_{3})\\sum_{X_{4}}f_{c}(X_{3}, X_{4})\\sum_{X_{5}}f_{d}(X_{4}, X_{5})) \\\\\nP(X_{3}) \u0026= \\underbrace{(\\sum_{X_{2}}f_{b}(X_{2}, X_{3})\\red{\\mu_{a\\rightarrow2}(X_{2})})}_{\\red{\\mu_{b\\rightarrow3}(X_{3})}}(\\sum_{X_{4}}f_{c}(X_{3}, X_{4})\\sum_{X_{5}}f_{d}(X_{4}, X_{5})) \\\\\nP(X_{4}) \u0026= \\underbrace{(\\sum_{X_{3}}f_{c}(X_{3}, X_{4})\\red{\\mu_{b\\rightarrow3}(X_{3})})}_{\\red{\\mu_{c\\rightarrow4}(X_{4})}}(\\sum_{X_{5}}f_{d}(X_{4}, X_{5})) \\\\\nP(X_{5}) \u0026= \\underbrace{\\sum_{X_{4}}f_{d}(X_{4}, X_{5})\\red{\\mu_{c\\rightarrow4}(X_{4})}}_{\\red{\\mu_{d\\rightarrow5}(X_{5})}}\n\\end{align*}\n$$\n\n![ml-bp-2](/images/ml-bp-2.jpg)\n\nì¦‰, ì´ì „ Marginalizationì—ì„œ ê³„ì‚°í–ˆë˜ $\\mu_{\\text{factor}\\rightarrow\\text{variable}}(X_{\\text{variable}})$ë¥¼ ì €ì¥í•´ì„œ, ë‹¤ìŒ Marginalization ì—°ì‚° ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì „ì²´ Marginalizationì„ êµ¬í•˜ëŠ”ë°ì—ë„ ë” ë¹ ë¥¸ ì—°ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤. ì´ ë°©ì‹ì€ ì—­ìœ¼ë¡œ ì§„í–‰í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•œë° ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n$$\n\\begin{align*}\nP(X_{4}) \u0026= (\\sum_{X_{3}}f_{c}(X_{3}, X_{4})\\sum_{X_{2}}f_{b}(X_{2}, X_{3})\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))\\underbrace{(\\sum_{X_{5}}f_{d}(X_{4}, X_{5}))}_{\\blue{\\mu_{d\\rightarrow4}(X_{4})}} \\\\\nP(X_{3}) \u0026= (\\sum_{X_{2}}f_{b}(X_{2}, X_{3})\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))\\underbrace{(\\sum_{X_{4}}f_{c}(X_{3}, X_{4})\\blue{\\mu_{d\\rightarrow4}(X_{4})})}_{\\blue{\\mu_{c\\rightarrow3}(X_{3})}} \\\\\nP(X_{2}) \u0026= (\\sum_{X_{1}}f_{a}(X_{1}, X_{2}))\\underbrace{(\\sum_{X_{3}}f_{b}(X_{2}, X_{3})\\blue{\\mu_{c\\rightarrow3}(X_{3})})}_{\\blue{\\mu_{b\\rightarrow2}(X_{2})}} \\\\\nP(X_{1}) \u0026= \\underbrace{\\sum_{X_{2}}f_{a}(X_{1}, X_{2})\\blue{\\mu_{b\\rightarrow2}(X_{2})}}_{\\blue{\\mu_{a\\rightarrow1}(X_{1})}}\n\\end{align*}\n$$\n\n![ml-bp-3](/images/ml-bp-3.jpg)\n\nì´ë¥¼ í•©ì³ì„œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ í˜•íƒœë¥¼ ê°€ì§€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\nP(X_{1}) \u0026= \\blue{\\mu_{a\\rightarrow1}(X_{1})} \u0026= \\red{\\mu^{-}(X_{1})}\\blue{\\mu^{+}(X_{1})} \\\\\nP(X_{2}) \u0026= \\red{\\mu_{a\\rightarrow2}(X_{2})}\\blue{\\mu_{b\\rightarrow2}(X_{2})}\u0026= \\red{\\mu^{-}(X_{2})}\\blue{\\mu^{+}(X_{2})} \\\\\nP(X_{3}) \u0026= \\red{\\mu_{b\\rightarrow3}(X_{3})}\\blue{\\mu_{c\\rightarrow3}(X_{3})}\u0026= \\red{\\mu^{-}(X_{3})}\\blue{\\mu^{+}(X_{3})} \\\\\nP(X_{4}) \u0026= \\red{\\mu_{c\\rightarrow4}(X_{4})}\\blue{\\mu_{d\\rightarrow4}(X_{4})}\u0026= \\red{\\mu^{-}(X_{4})}\\blue{\\mu^{+}(X_{4})} \\\\\nP(X_{5}) \u0026= \\red{\\mu_{d\\rightarrow5}(X_{5})}\u0026= \\red{\\mu^{-}(X_{5})}\\blue{\\mu^{+}(X_{5})} \\\\\n\u0026\\therefore P(X_{i}) = \\red{\\mu^{-}(X_{i})}\\blue{\\mu^{+}(X_{i})} \\\\\n\\end{align*}\n$$\n\n![ml-bp-4](/images/ml-bp-4.jpg)\n\n$\\mu^{+}$ì™€ $\\mu^{-}$ì˜ ë°©í–¥ì´ í—·ê°ˆë¦´ ìˆ˜ ìˆëŠ”ë°, ì´ëŠ” ìì‹ ($X_{i}$)ì„ ê¸°ì¤€ìœ¼ë¡œ í° ìª½ì—ì„œ ì™”ëŠ”ì§€ ì‘ì€ ìª½ì—ì„œ ì™”ëŠ”ì§€ë¥¼ í‘œì‹œí•œë‹¤ê³  ìƒê°í•˜ë©´ ì‰½ë‹¤. ë”°ë¼ì„œ, $\\mu$ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ë˜ì–´ì§ˆ ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\n\\mu^{-}(X_{1}) \u0026= 1,\\, \\mu^{+}(X_{N}) = 1 \\text{ì´ê³ ,}\\\\\n\\mu^{-}(X_{i}) \u0026= \\sum_{X_{i-1}}f_{i}(i-1, i)\\mu^{-}(X_{i-1}) \\\\\n\\mu^{+}(X_{i}) \u0026= \\sum_{X_{i+1}}f_{i}(i, i+1)\\mu^{+}(X_{i+1}) \\\\\n\\end{align*}\n$$\n\nì—¬ê¸°ì„œ $\\mu$ê°€ ë°”ë¡œ \u003cmark\u003e**Message**\u003c/mark\u003eë¥¼ ì˜ë¯¸í•œë‹¤. ì¦‰, ìš°ë¦¬ê°€ ë§ˆì¹˜ ìš´ë™ì¥ì—ì„œ ì‚¬ëŒ ìˆ˜ë¥¼ ì„¸ê¸° ìœ„í•´ì„œ ì• ì‚¬ëŒì´ ë§í•œ ìˆ˜ + 1ì„ ë°˜ë³µí•˜ë©´ì„œ ì§„í–‰í•˜ëŠ” ê²ƒì²˜ëŸ¼ Messageë¥¼ ì „ë‹¬í•˜ë©° ì „ì²´ í™•ë¥ ì„ êµ¬í•´ë‚˜ê°€ëŠ” ê²ƒì´ë‹¤. ì´ëŸ¬í•œ ë°©ë²•ì„ **Message Passing**ì´ë¼ê³  í•˜ë©°, ì´ ë°©ë²•ì„ í†µí•´ì„œ ìš°ë¦¬ëŠ” Marginal Probabilityë¥¼ ë” íš¨ê³¼ì ìœ¼ë¡œ êµ¬í•  ìˆ˜ ìˆë‹¤. ì™œëƒí•˜ë©´, $\\mu^{-}(X_{i})$ë¥¼ êµ¬í•˜ê¸° ìœ„í•œ ì—°ì‚°ëŸ‰ì´ $(i-1) \\times L$ì´ë¼ëŠ” ê²ƒê³¼, $mu^{+}(X_{i})$ë¥¼ êµ¬í•˜ê¸° ìœ„í•œ ì—°ì‚°ëŸ‰ì´ $(N-i) \\times L$ì´ë¼ëŠ” ê²ƒì„ ì•Œê³  ìˆë‹¤. ë”°ë¼ì„œ, ê° ê°ì˜ Marginalizationì„ êµ¬í•˜ê¸° ìœ„í•œ ì—°ì‚°ëŸ‰ì´ $L^{N-1}$ì—ì„œ $(N-1)L$ë¡œ ì¤„ì–´ë“¤ì—ˆë‹¤.\n\nì—¬ê¸°ê¹Œì§€ ìš°ë¦¬ëŠ” Lineìœ¼ë¡œ ë˜ì–´ìˆëŠ” ê°€ì¥ ê°„ë‹¨í•œ Factor Graphì—ì„œì˜ \u003cmark\u003e**Sum-Product Belief Propagation**\u003c/mark\u003eì„ ì•Œì•„ë³¸ ê²ƒì´ë‹¤. ì´ì œë¶€í„° ìš°ë¦¬ëŠ” ë” ë³µì¡í•œ ìƒí™©ì—ì„œì˜ Belief Propagation(BP)ì„ ì‚´í´ë³¼ ê²ƒì´ë‹¤. Belief Propagationê³¼ Message Passingì€ ëŒ€ê²Œ ë¹„ìŠ·í•œ ì˜ë¯¸ë¡œ ì‚¬ìš©ë˜ì–´ ì§„ë‹¤(ì¼ë¶€ëŠ” Message Passing í›„ì— ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ì‘ì—…ì„ ë¶„ë¦¬í•˜ê³  ì´ë¥¼ í†µí•©í•˜ì—¬ Belief Propagationì´ë¼ê³  í•˜ê¸°ë„ í•œë‹¤.)\n\n### Sum-Product Belief Propagation\n\ní•©ì˜ ê³±ì„ í†µí•´ì„œ Marginal Probabilityë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ, ì• ì„œ ë³´ì•˜ë˜ Linear Factor Graph ë¿ë§Œ ì•„ë‹ˆë¼ Treeí˜•íƒœì˜ Factor Graphì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë¬¼ë¡  Cycleì´ ì¡´ì¬í•˜ëŠ” Factor Graphê°€ ì¡´ì¬í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì´ ê²½ìš°ì— ëŒ€í•´ì„œëŠ” íŠ¹ë³„í•œ ì•Œê³ ë¦¬ì¦˜ì„ ë³„ë„ë¡œ ì ìš©í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤. ë”°ë¼ì„œ, ì—¬ê¸°ì„œëŠ” Treeí˜•íƒœì˜ Factor Graphì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œì‹œí•œë‹¤.\n\nìš°ì„  ì•„ë˜ ê·¸ë¦¼ì„ í†µí•´ì„œ ëŒ€ëµì ì¸ ì´í•´ë¥¼ í•´ë³´ë„ë¡ í•˜ì.\n\n![ml-sum-product-bp-1](/images/ml-sum-product-bp-1.jpg)\n\nìš°ë¦¬ëŠ” ìœ„ì—ì„œ Line Factor Graphì—ì„œ ì–´ë–»ê²Œ Marginal Probabilityë¥¼ ì–´ë–»ê²Œ êµ¬í•˜ëŠ”ì§€ë¥¼ ë³´ì•˜ë‹¤. Tree êµ¬ì¡°ì—ì„œë„ ë™ì¼í•˜ê²Œ ê²°êµ­ Marginal Probabilityë¥¼ ìì‹ ê³¼ ì´ì›ƒí•œ Factor Nodeë“¤ë¡œ ë¶€í„° ì „ë‹¬ëœ Messageì˜ ê³±ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤. ë‹¨ì§€ ë‹¤ë¥¸ ì ì€ ì´ì›ƒí•œ factorê°€ ë³µìˆ˜ ê°œë¼ëŠ” ê²ƒì´ë‹¤.  \n(factor ë˜ëŠ” variableì— í•´ë‹¹í•˜ëŠ” Node ì¤‘ì—ì„œ indexê°€ iì¸ Nodeì™€ ì¸ì ‘í•œ Node(Node iê°€ factorë¼ë©´ variable, variableì´ë¼ë©´ factorì´ë‹¤.)ë“¤ì˜ index ì§‘í•©ì„ $\\mathcal{N}_{i}$ ë¼ê³ í•˜ê³ , ê°’ì€ ì¢…ë¥˜ì˜ Nodeì˜ indexë¥¼ ëª¨ì•„ë‘” ì§‘í•© Iê°€ ìˆì„ ë•Œ $X_{I} = \\{X_{i}\\}_{i \\in I}$ë¼ê³  í•˜ì.)\n\n$$\nP(X_{i}) = \\prod_{p \\in \\mathcal{N}_{i}}\\mu_{p \\rightarrow i}(X_{i})\n$$\n\nê·¸ë ‡ë‹¤ë©´, ì—¬ê¸°ì„œ $\\mu_{p \\rightarrow i}(X_{i})$ë¥¼ ê° ê° ì–´ë–»ê²Œ êµ¬í•  ìˆ˜ ìˆì„ê¹Œ? ê·¸ëŸ¬ê¸° ìœ„í•´ì„œ ë¹¨ê°„ìƒ‰ ë¶€ë¶„ì„ ìì„¸íˆ ë´ë³´ì.\n\n![ml-sum-product-bp-2](/images/ml-sum-product-bp-2.jpg)\n\nì—¬ê¸°ì„œë„ ê¸°ì¡´ Linear Factor Graphì™€ ë‹¤ë¥¸ ì ì€ Factor Nodeì—­ì‹œ ì—¬ëŸ¬ ê°œì˜ Variable Nodeì™€ ì—°ê²°ëœë‹¤ëŠ” ì ì´ë‹¤. ì´ ë¶€ë¶„ë§Œ ë–¼ì–´ì„œ ìì„¸íˆ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n![ml-sum-product-bp-3](/images/ml-sum-product-bp-3.jpg)\n\nê·¸ë ‡ê¸°ì— ì´ì „ Variable Nodeë¡œ ë¶€í„° ì˜¤ëŠ” Messageë“¤ê³¼ factor ê°’ì„ í•¨ê»˜ ê³±í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤. ì—¬ê¸°ì„œ, Varaible Nodeì—ì„œ factor Nodeë¡œ ì˜¤ëŠ” Messageë¥¼ $\\nu$ë¼ê³  ì •ì˜í•œë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. ì—¬ê¸°ì„œ ì£¼ì˜í•  ì ì€ Factor Nodeì™€ ì´ì›ƒí•œ Variable Node ì¤‘ì—ì„œ Messageë¥¼ ì „ë‹¬í•  Variable NodeëŠ” ì—°ì‚°ì—ì„œ ì œì™¸í•´ì•¼ í•œë‹¤ëŠ” ì ì´ë‹¤.\n\n$$\n\\mu_{u \\rightarrow i}(X_{i}) = \\sum_{X_{\\mathcal{N}_{u}\\backslash\\{i\\}}}f_{u}(X_{\\mathcal{N}})\\prod_{j \\in \\mathcal{N}\\backslash\\{i\\}}{\\nu_{j \\rightarrow u}(x_{j})}\n$$\n\nê·¸ë¦¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ $\\nu$ë¥¼ êµ¬í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n![ml-sum-product-bp-4](/images/ml-sum-product-bp-4.jpg)\n\n$$\n\\nu_{j \\rightarrow u}(X_{j}) = \\prod_{v \\in \\mathcal{N}_{j}\\backslash\\{u\\}}\\mu_{v \\rightarrow j}(X_{j})\n$$\n\në”°ë¼ì„œ, Marginal Probability($P(X_{i})$)ë¥¼ êµ¬í•˜ê³ ì í•  ë•Œ ìš°ë¦¬ëŠ” Leaf Nodeì—ì„œ ë¶€í„° ì‹œì‘í•´ì„œ ì°¨ë¡€ì°¨ë¡€ ê°’ì„ êµ¬í•˜ë©´ì„œ, $\\mu_{\\mathcal{N}_{i} \\rightarrow i}$ë¥¼ ëª¨ë‘ êµ¬í•  ë•Œê¹Œì§€ ì—°ì‚°ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.\n\n```plaintext\n ğŸ¤” Loopy Sum-Product BP\n\n ìš°ë¦¬ëŠ” Sum-Product BPë¥¼ Treeì—ì„œë§Œ ì“¸ ìˆ˜ ìˆë‹¤ê³  ì œí•œí•˜ì˜€ì§€ë§Œ, \n ì‚¬ì‹¤ Cycleì´ ì¡´ì¬í•˜ëŠ” Factor Graphì—ì„œë„ ë™ì¼í•œ BPë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.\n í•˜ì§€ë§Œ, ì´ ê²½ìš°ì—ëŠ” ë¹„ë¡€ ê´€ê³„ë¥¼ í†µí•´ì„œ ë‚˜íƒ€ë‚¼ ìˆ˜ ë°–ì— ì—†ê¸° ë•Œë¬¸ì—\n ê²°ê³¼ê°’ì— ëŒ€í•´ì„œ 100% í™•ì‹ í•  ìˆ˜ëŠ” ì—†ë‹¤.\n```\n\n### Max Product Belief Propagation\n\nBelief Propagationì€ ì• ì„œ ì‚´í´ë³´ì•˜ë˜ Marginal Probabilityë¥¼ êµ¬í•  ë•Œì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, Maximization ë¬¸ì œë¥¼ í’€ ë•Œì—ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ ê°€ì¥ ê°„ë‹¨í•œ ì˜ˆì‹œì¸ Linear Factor Graphë¥¼ ê°€ì •í•´ë³´ì.\n\n![ml-bp-1](/images/ml-bp-1.jpg)\n\n$$\nP(X_{1}, X_{2}, X_{3}, X_{4}, X_{5}) = f_{a}(X_{1}, X_{2})f_{b}(X_{2}, X_{3})f_{c}(X_{3}, X_{4})f_{d}(X_{4}, X_{5})\n$$\n\nì´ ê²½ìš°ì— $P(X_{1}, X_{2}, X_{3}, X_{4}, X_{5})$ë¥¼ ìµœëŒ€ë¡œ ë§Œë“œëŠ” $\\hat{x_{1}}, \\hat{x_{2}}, \\hat{x_{3}}, \\hat{x_{4}}, \\hat{x_{5}}$ë¥¼ ì°¾ì•„ë³´ì.  \n\n$$\n\\begin{align*}\n\u0026\\max_{X_{1}, X_{2}, X_{3}, X_{4}, X_{5}} f_{a}(X_{1}, X_{2})f_{b}(X_{2}, X_{3})f_{c}(X_{3}, X_{4})f_{d}(X_{4}, X_{5})\\\\\n\u0026= \\max_{X_{1}}\\{f_{a}(X_{1}, X_{2})\\max_{X_{2}}\\{\\max_{X_{3}}\\{f_{b}(X_{2}, X_{3}) \\max_{X_{4}}\\{f_{c}(X_{3}, X_{4})\\max_{X_{5}}\\{f_{d}(X_{4}, X_{5})\\}\\}\\}\\}\\}\\\\\n\u0026= \\max_{X_{2}}\\{\\max_{X_{1}}\\{f_{a}(X_{1}, X_{2})\\} \\max_{X_{3}}\\{f_{b}(X_{2}, X_{3}) \\max_{X_{4}}\\{f_{c}(X_{3}, X_{4})\\max_{X_{5}}\\{f_{d}(X_{4}, X_{5})\\}\\}\\}\\}\\\\\n\u0026= \\max_{X_{3}}\\{\\max_{X_{2}}\\{f_{b}(X_{2}, X_{3})\\max_{X_{1}}\\{f_{a}(X_{1}, X_{2})\\}\\} \\max_{X_{4}}\\{f_{c}(X_{3}, X_{4})\\max_{X_{5}}\\{f_{d}(X_{4}, X_{5})\\}\\}\\}\\\\\n\u0026= \\max_{X_{4}}\\{\\max_{X_{3}}\\{f_{c}(X_{3}, X_{4})\\max_{X_{2}}\\{f_{b}(X_{2}, X_{3})\\max_{X_{1}}\\{f_{a}(X_{1}, X_{2})\\}\\}\\}\\max_{X_{5}}\\{f_{d}(X_{4}, X_{5})\\}\\}\\\\\n\u0026= \\max_{X_{5}}\\{f_{d}(X_{4}, X_{5})\\max_{X_{4}}\\{\\max_{X_{3}}\\{f_{c}(X_{3}, X_{4})\\max_{X_{2}}\\{f_{b}(X_{2}, X_{3})\\max_{X_{1}}\\{f_{a}(X_{1}, X_{2})\\}\\}\\}\\}\\}\\\\\n\\end{align*}\n$$\n\nMarginalizationê³¼ êµ‰ì¥íˆ ìœ ì‚¬í•˜ë‹¤ê³  í•˜ë‹¤. ì´ë¥¼ ì´ì „ì— ì‚¬ìš©í•œ Tree êµ¬ì¡°ì— ë°˜ì˜í•´ë„ ë™ì¼í•˜ë‹¤.\n\n![ml-sum-product-bp-1](/images/ml-sum-product-bp-1.jpg)\n\në‹¨, ì—¬ê¸°ì„œ Messageì™€ ìµœì¢… ê²°ê³¼ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì¬ì •ì˜í•˜ë©´ ëë‚œë‹¤.\n\n$$\n\\begin{align*}\n\\max P(X_{1}, X_{2}, \\cdots, X_{N}) \u0026= \\max_{X_{i}}\\{\\prod_{p\\in\\mathcal{N}_{i}}\\mu_{p \\rightarrow i}(X_{i})\\} \\\\\n\\mu_{u \\rightarrow i}(X_{i}) \u0026= \\max_{\\mathcal{N}_{u}\\backslash\\{i\\}}\\{f_{u}(\\mathcal{N}_{i})\\prod_{j \\in \\mathcal{N}_{u}\\backslash\\{i\\}}\\nu_{j \\rightarrow u}(X_{j})\\} \\\\\n\\nu_{j \\rightarrow u}(X_{j}) \u0026= \\prod_{v\\in\\mathcal{N}_{j}\\backslash\\{u\\}}\\mu_{v \\rightarrow j}(X_{j})\n\\end{align*}\n$$\n\nì¶”ê°€ì ìœ¼ë¡œ Max Sum Belief Propagationì„ ì†Œê°œí•˜ê² ë‹¤. ì´ëŠ” Maximization ë¬¸ì œë¥¼ í’€ ë•Œ, $\\log$ë¥¼ ì·¨í•œ ê²°ê³¼ë„ ë™ì¼í•˜ë‹¤ëŠ” ì ì„ í™œìš©í•˜ì—¬ ë¬¸ì œë¥¼ í‘¸ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ, ë‹¤ìŒê³¼ ê°™ì´ ì‹ì´ ì¡°ê¸ˆ ë³€í™”í•œë‹¤. ì´ ë°©ì‹ì„ ì“°ë©´, ë„ˆë¬´ ì‘ì€ probabilityë¡œ ì¸í•œ ë¬¸ì œë¥¼ í”¼í•  ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\n\\max \\red{\\log} P(X_{1}, X_{2}, \\cdots, X_{N}) \u0026= \\max_{X_{i}}\\{\\red{\\sum_{p\\in\\mathcal{N}_{i}}}\\mu_{p \\rightarrow i}(X_{i})\\} \\\\\n\\mu_{u \\rightarrow i}(X_{i}) \u0026= \\max_{\\mathcal{N}_{u}\\backslash\\{i\\}}\\{\\red{\\log} f_{u}(\\mathcal{N}_{i}) + \\red{\\sum_{j \\in \\mathcal{N}_{u}\\backslash\\{i\\}}}\\nu_{j \\rightarrow u}(X_{j})\\} \\\\\n\\nu_{j \\rightarrow u}(X_{j}) \u0026= \\red{\\sum_{v\\in\\mathcal{N}_{j}\\backslash\\{u\\}}}\\mu_{v \\rightarrow j}(X_{j})\n\\end{align*}\n$$\n\n## Construction from Data\n\nì•ì—ì„œëŠ” Graphë¥¼ í†µí•´ì„œ ì—°ì‚° ê³¼ì •ì„ Optimizationí•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ë‹¤ë©´, ì—¬ê¸°ì„œëŠ” ì‹¤ì œ ê´€ì¸¡ dataë¥¼ ì´ìš©í•´ì„œ ì–´ë–»ê²Œ Graphë¥¼ êµ¬ì¡°í™”í•  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•´ì„œ ì•Œì•„ë³¼ ê²ƒì´ë‹¤. ì´ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ë§ì€ Algorithmì´ ì¡´ì¬í•˜ì§€ë§Œ ê°€ì¥ ê¸°ë³¸ì´ ë  ìˆ˜ ìˆëŠ” Algorithmì¸ **Chow-Liu Algorithm**ë§Œ ì‚´í´ë³´ë„ë¡ í•˜ê² ë‹¤.\n\n### Chow-Liu Algorithm\n\nì œì¼ ë¨¼ì € êµ¬í•´ì•¼í•  ê²ƒì€ **Joint Probability**ì´ë‹¤. ì´ëŠ” Empirical distributionì„ ì´ìš©í•˜ì—¬ êµ¬í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ëŠ” featureê°€ Nê°œì¸ ì´ Kê°œì˜ dataê°€ ìˆì„ ë•Œ, ë‹¤ìŒê³¼ ê°™ì´ **Joint Probability**ë¥¼ êµ¬í•œ ê²ƒì´ë‹¤.\n\n$$\np(X_{1}=x_{1}, X_{2}=x_{2}, \\cdots, X_{N}=x_{n}) = \\frac{1}{K} \\sum_{k=1}^{K} \\mathbb{1}[x^{(k)}=(x_{1}, x_{2}, \\cdots, x_{n})]\n$$\n\nìœ„ì™€ ê°™ì´ **Joint Probability**ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, **Chow-Liu Algorithm**ì—ì„œëŠ” **Second Order Conditional Probability**(ì´ ë‘ê°œì˜ Random Variableë¡œ êµ¬ì„±ëœ Conditional Probability. ì¦‰, Condtionë„ í•˜ë‚˜ì´ê³ , í™•ë¥ ì„ êµ¬í•˜ê³ ì í•˜ëŠ” ë³€ìˆ˜ë„ í•˜ë‚˜ì´ë‹¤.)ì™€ **Marginal Probability**ë¡œ Graphë¥¼ ê°€ì •í•˜ê³  **Bayesian Network**ë¥¼ êµ¬ì„±í•œë‹¤. ì´ ê²½ìš°ì—ëŠ” í˜•íƒœê°€ Tree í˜•íƒœë¡œ ë§Œë“¤ì–´ì§€ê¸° ë•Œë¬¸ì— ê²°ë¡ ì ìœ¼ë¡œ head-to-head ê´€ê³„ê°€ ë§Œë“¤ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤.(ê° ê°ì˜ nodeëŠ” í•˜ë‚˜ì˜ parentë§Œ ê°–ê¸° ë•Œë¬¸ì´ë‹¤.)\n\n![ml-chow-liu-1](/images/ml-chow-liu-1.jpg)\n\në”°ë¼ì„œ, ìœ„ì™€ ê°™ì€ Graphë¡œ ì¶”ì •í–ˆë‹¤ë©´, í™•ë¥ ì€ ë‹¤ìŒê³¼ ê°™ì•„ì§„ë‹¤.\n\n$$\np(x_{1}, x_{2}, \\cdots, x_{n}) = p(x_{6}|x_{5})p(x_{5}|x_{2})p(x_{4}|x_{2})p(x_{3}|x_{2})p(x_{2}|x_{1})p(x_{1})\n$$\n\nì—¬ê¸°ì„œ ì´ì œ ìš°ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œë§Œ í’€ë©´ ëì´ë‹¤. Empirical distributionìœ¼ë¡œ êµ¬í•œ Joint Probability($p$)ì™€ ìš°ë¦¬ê°€ ì¶”ì •í•œ Graphì—ì„œì˜ Joint Probability($p_{\\intercal}$)ì‚¬ì´ì˜ ì°¨ì´ê°€ ìµœì†Œê°€ ë˜ë„ë¡ í•˜ë©´ ëœë‹¤. ì´ë¥¼ ìœ„í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ **KL Divergence**ì´ë‹¤. ë”°ë¼ì„œ, ìš°ë¦¬ê°€ êµ¬í•˜ê³  ì‹¶ì€ **Bayesian Network**ëŠ” ë‹¤ìŒê³¼ ê°™ì´ êµ¬í•  ìˆ˜ ìˆë‹¤.\n\n$$\n\\argmin_{\\intercal\\text{:tree}} KL(p||p_{\\intercal})) = \\argmin_{\\intercal\\text{:tree}} \\sum_{x^{(k)} \\in \\mathcal{D}}p(x^{(k)})\\log \\frac{p(x^{(k)})}{p_{\\intercal}(x^{(k)})}\n$$\n\nê·¸ë ‡ë‹¤ë©´, ì¢€ ë” ë©´ë°€í•˜ê²Œ $p_{\\intercal}$ì„ ì •ì˜í•´ë³´ì.\n\n$$\n\\begin{align*}\np_{\\intercal}(x_{1}, x_{2}, \\cdots, x_{N}) \u0026= \\prod_{i=1}^{N}p(x_{i}|x_{\\text{parent}(i)})\\, (\\because \\text{Bayesian Network Definition})\\\\\n\u0026= p(x_{root})\\prod_{(i,j) \\in E}p(x_{j}|x_{i})\n\\end{align*}\n$$\n\nì—¬ê¸°ì„œ VëŠ” nodeì˜ ì§‘í•©ì„ ì˜ë¯¸í•˜ê³ , EëŠ” edgeë¥¼ ì €ì¥í•˜ë©° ê° tuple(i,j)ëŠ” (parent, child)ë¥¼ ì˜ë¯¸í•œë‹¤. ê·¸ë¦¬ê³ , Treeì—ì„œëŠ” ë‹¨ í•˜ë‚˜ì˜ Nodeë§Œ Rootì´ê³  parentê°€ ì—†ê¸° ë•Œë¬¸ì— í•´ë‹¹ Rootë§Œ marginal Probabilityë¥¼ ê°€ì§€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\np_{\\intercal}(x_{1}, x_{2}, \\cdots, x_{N}) \u0026= p(x_{root})\\prod_{(i,j) \\in E}p(x_{j}|x_{i})\\\\\n\u0026= p(x_{root})\\prod_{(i,j) \\in E} \\frac{p(x_{j},x_{i})}{p(x_{i})}\\\\\n\u0026= \\red{p(x_{root})}\\prod_{(i,j) \\in E} \\frac{p(x_{j},x_{i})\\red{p(x_{j})}}{p(x_{i})p(x_{j})}\\\\\n\u0026= \\prod_{i\\in V}p(x_{i}) \\prod_{(i,j) \\in E} \\frac{p(x_{j},x_{i})}{p(x_{i})p(x_{j})}\\\\\n\\end{align*}\n$$\n\në§ˆì§€ë§‰ì´ ì¢€ ì• ë§¤í•  ìˆ˜ ìˆëŠ” treeì´ê¸° ë•Œë¬¸ì— ê°€ëŠ¥í•œ ê²ƒì´ë‹¤. íŠ¹ì • nodeë¡œ ê°€ëŠ” pathëŠ” ë‹¨ í•˜ë‚˜ì´ê¸° ë•Œë¬¸ì— $j$ë¡œ ëë‚˜ëŠ” edgeë„ í•˜ë‚˜ì¼ ìˆ˜ ë°–ì— ì—†ë‹¤. ë”°ë¼ì„œ, $p(x_{root})\\prod_{(i,j) \\in E} p(x_{j}) = \\prod_{i=V}p(x_{i})$ì¼ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.\n\nì´ê²ƒì´ ì •ì˜ë˜ë©´, ìš°ë¦¬ëŠ” ì´ì œ ìµœì ì˜ Treeì¸ $\\intercal_{*}$ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤.\n\n$$\n\\begin{align*}\n\\intercal_{*} \u0026= \\argmin_{\\intercal\\text{:tree}} KL(p||p_{\\intercal})\\\\\n\u0026= \\argmin_{\\intercal\\text{:tree}} \\sum_{x^{(k)} \\in \\mathcal{D}}p(x^{(k)})\\log \\frac{p(x^{(k)})}{p_{\\intercal}(x^{(k)})}\\\\\n\u0026= \\argmin_{\\intercal\\text{:tree}} \\sum_{x^{(k)} \\in \\mathcal{D}}\\cancel{p(x^{(k)})\\log{p(x^{(k)})}} -p(x^{(k)})\\log{p_{\\intercal}(x^{(k)})}\\\\\n\u0026= \\argmax_{\\intercal\\text{:tree}} \\sum_{x^{(k)} \\in \\mathcal{D}}p(x^{(k)})\\log{p_{\\intercal}(x^{(k)})}\\\\\n\u0026= \\argmax_{\\intercal\\text{:tree}} \\sum_{x^{(k)} \\in \\mathcal{D}}p(x^{(k)})\\log({\\prod_{i\\in V}p(x_{i}^{(k)}) \\prod_{(i,j) \\in E} \\frac{p(x_{j}^{(k)},x_{i}^{(k)})}{p(x_{i}^{(k)})p(x_{j}^{(k)})}})\\\\\n\u0026= \\argmax_{\\intercal\\text{:tree}} \\sum_{x^{(k)} \\in \\mathcal{D}}\\sum_{i\\in V}p(x^{(k)})\\log(p(x_{i}^{(k)})) + \\sum_{x^{(k)} \\in \\mathcal{D}}\\sum_{(i,j) \\in E} p(x^{(k)})\\log({\\frac{p(x_{j}^{(k)},x_{i}^{(k)})}{p(x_{i}^{(k)})p(x_{j}^{(k)})}})\\\\\n\u0026= \\argmax_{\\intercal\\text{:tree}} \\sum_{i\\in V}\\sum_{x^{(k)} \\in \\mathcal{D}}p(x^{(k)})\\log(p(x_{i}^{(k)})) + \\sum_{(i,j) \\in E}\\sum_{x^{(k)}_{i}, x^{(k)}_{j}} p(x^{(k)}_{i}, x^{(k)}_{j})\\log({\\frac{p(x_{j}^{(k)},x_{i}^{(k)})}{p(x_{i}^{(k)})p(x_{j}^{(k)})}})\\, (\\because \\text{marginalization})\\\\\n\u0026= \\argmax_{\\intercal\\text{:tree}} \\cancel{\\sum_{i\\in V}-H(X_{i})} + \\sum_{(i,j) \\in E}I(X_{i}, X_{j})\\, (\\because H(X_{i})\\text{ëŠ” constantì´ë‹¤.})\\\\\n\u0026= \\argmax_{\\intercal\\text{:tree}}\\sum_{(i,j) \\in E}I(X_{i}, X_{j})\\\\\n\\end{align*}\n$$\n\në§ˆì§€ë§‰ marginalizationì€ í—·ê°ˆë¦°ë‹¤ë©´, í•´ë‹¹ Postingì˜ Sum-Product BP ë¶€ë¶„ì„ ë‹¤ì‹œ ë³´ê³ ì˜¤ë„ë¡ í•˜ì.\n\nì, ì´ì œ ìš°ë¦¬ê°€ ì–»ì€ ê²°ë¡ ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. ê²°êµ­, ìµœì ì˜ TreeëŠ” $I(X_{i}, X_{j})$ê°€ ìµœëŒ€ê°€ ë˜ëŠ” Treeì´ë‹¤. I(Mutual Information)ì´ í—·ê°ˆë¦°ë‹¤ë©´, [Information Theory](/posts/ml-base-knowledge#Information-Theory) ì •ë¦¬í•´ë†“ì€ Postingì„ ë‹¤ì‹œ ë³´ê³  ì˜¤ì. ê²°êµ­, $X_{i}, X_{j}$ê°„ì˜ ëª¨ë“  Mutual Informationì„ êµ¬í•´ì„œ weighted graphë¥¼ êµ¬ì¶•í•œë‹¤ìŒì— Kruskal Algorithmì„ í†µí•´ì„œ ìµœì  Treeë¥¼ ì°¾ìœ¼ë©´ ë˜ëŠ” ê²ƒì´ë‹¤.\n\në”°ë¼ì„œ, ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n1. ê°€ëŠ¥í•œ ëª¨ë“  (i,j) ìŒì— ëŒ€í•˜ì—¬ $I(X_{i}, X_{j})$ë¥¼ êµ¬í•˜ì—¬, Weighted Graphë¥¼ êµ¬ì„±í•œë‹¤.\n2. Kruskal Algorithmì„ ìˆ˜í–‰í•œë‹¤.\n   1. weightì˜ ë‚´ë¦¼ì°¨ìˆœìœ¼ë¡œ Edgeë¥¼ ì •ë ¬í•œë‹¤.\n   2. í•˜ë‚˜ì”© Edgeë¥¼ ë½‘ìœ¼ë©´ì„œ, Cycleì´ ìƒê¸°ëŠ”ì§€ í™•ì¸í•˜ì—¬ ìƒê¸°ë©´ ë²„ë¦¬ê³ , Cycleì´ ìƒê¸°ì§€ ì•Šìœ¼ë©´ Treeì— ì¶”ê°€í•œë‹¤.(Cycle ì—¬ë¶€ëŠ” ë™ì¼í•œ Nodeê°€ ë‘ ê°œ ë‹¤ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸)\n   3. ëª¨ë“  Nodeë¥¼ ë½‘ì•˜ë‹¤ë©´ ì¢…ë£Œí•˜ê³ , ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ 2ë²ˆì„ ë°˜ë³µ ì‹œí–‰í•œë‹¤.\n\nì´ë ‡ê²Œ Graphë¥¼ ë§Œë“¤ê²Œ ë˜ë©´, ìš°ë¦¬ëŠ” Joint Probabilityë¥¼ ì´ì „ì— ë°°ìš´ Optimization ë°©ë²•ì„ í†µí•´ì„œ ì‰½ê²Œ êµ¬í•  ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ê³ , ì´ë¥¼ Modelì— ì§ì ‘ ì ìš©í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´, ìš°ë¦¬ê°€ Classificationì„ ìˆ˜í–‰í•  ë•Œì´ë‹¤.\n\n$$\n\\argmax_{\\mathcal{l} \\in \\{0,1,2,\\cdots, 9\\}} p_{\\mathcal{l}} \\times p(x^{\\text{new}}|\\mathcal{l}^{\\text{new}}=\\mathcal{l}) \\propto \\argmax_{\\mathcal{l} \\in \\{0,1,2,\\cdots, 9\\}} p_{\\mathcal{l}} \\times p_{\\intercal}(x^{\\text{new}})\n$$\n\nìœ„ì™€ ê°™ì´ ì¶”ì •í•˜ì—¬ ê³„ì‚°ì„ íšê¸°ì ìœ¼ë¡œ ì¤„ì¼ ìˆ˜ ìˆë‹¤.\n\n## Reference\n\n- Tumbnail : Photo by [Markus Winkler](https://unsplash.com/@markuswinkler?utm_source=unsplash\u0026utm_medium=referral\u0026utm_content=creditCopyText) on [Unsplash](https://unsplash.com/@markuswinkler?utm_source=unsplash\u0026utm_medium=referral\u0026utm_content=creditCopyText)\n- Medium[Chullin], Graphical Modelì´ë€ ë¬´ì—‡ì¸ê°€ìš”?, \u003chttps://medium.com/@chullino/graphical-model%EC%9D%B4%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80%EC%9A%94-2d34980e6d1f\u003e\n- Wiki, Markov Random Field, \u003chttps://en.wikipedia.org/wiki/Markov_random_field\u003e\n- Adaptive Computation and Machine Learning, Thomas G. Dietterich\n- \u003chttps://cedar.buffalo.edu/~srihari/CSE574/Chap8/Ch8-PGM-Inference/Ch8.3.2-FactorGraphs.pdf\u003e\n","slug":"ml-graphical-model","date":"2022-11-14 13:08","title":"[ML] 8. Graphical Model","category":"AI","tags":["ML","GraphicalModel","ConditionalIndependence","MarkovRandomField","BayesianNetwork","FactorGraph","D-Seperation","Factorization","MarkovProperty","MessagePassing","BeliefPropagation","Chow-LiuAlgorithm"],"desc":"Machine Learningì€ ì£¼ì–´ì§„ dataë¥¼ ê°€ì¥ ì˜ ì„¤ëª…í•  ìˆ˜ ìˆëŠ” pattern(Model)ì„ ì°¾ëŠ” ê²ƒì´ ëª©í‘œë¼ê³  í•˜ì˜€ë‹¤. ê·¸ë ‡ë‹¤ë©´, \"dataê°€ ê°€ì§€ëŠ” ì—¬ëŸ¬ê°€ì§€ ì •ë³´(feature)ë“¤ ì¤‘ì—ì„œ ì–´ë–¤ featureë¥¼ ì¤‘ì ì ìœ¼ë¡œ ë³´ê³  ì´ìš©í•  ìˆ˜ ìˆì„ê¹Œ?\" ê·¸ë¦¬ê³ , \"ë§Œì•½ ì—¬ëŸ¬ featureë“¤ì´ ì„œë¡œ ì—°ê´€ì´ ìˆë‹¤ë©´ ì´ë¥¼ ì—°ì‚°ì˜ ìµœì í™”ë¥¼ ìœ„í•´ ì´ìš©í•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ?\" ë¼ëŠ” ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. ì—¬ê¸°ì„œ Graphical Modelì€ ì´ëŸ¬í•œ ê´€ê³„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ì„œ ì—°ì‚° ìµœì í™”ì— ëŒ€í•œ insightë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤.","thumbnailSrc":"https://euidong.github.io/images/ml-thumbnail.jpg"}],"params":{"subject":"MarkovRandomField"}},"__N_SSG":true},"page":"/tags/[subject]","query":{"subject":"MarkovRandomField"},"buildId":"iF6oy44c8AvnW0OMrDCE5","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>