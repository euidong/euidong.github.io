{"pageProps":{"post":{"content":"\n## Intro\n\ní•´ë‹¹ ê¸€ì€ manifest version 3ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ëœ ê¸€ì…ë‹ˆë‹¤. í˜¹ì—¬ version 2ë¥¼ ì´ìš©í•˜ì…¨ë‹¤ë©´, version 2ì—ì„œ version 3ë¡œ migration í•˜ë©´ì„œ ì œê°€ ì ì–´ë†“ì€ ê¸€ì´ ìˆìœ¼ë‹ˆ ê·¸ê²ƒì„ ì°¸ê³  í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.\n\n[Chrome Extension version migration from V2 to V3](/posts/chrome-extension-migration-v2-to-v3)\n\n## 1. chrome í™•ì¥ ì•±ì˜ êµ¬ì„±\n\nchrome extensionì—ì„œ manifest versionì´ 3ì´ ë˜ì–´ ì´ë¥¼ í•œ ë²ˆ ì •ë¦¬í•  ê²¸,  \nchrome í™•ì¥ì•±ì„ êµ¬ì„±í•˜ëŠ” componentëŠ” í¬ê²Œ 5ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n1. Background scripts => ëŒ€ê²Œ eventë¥¼ ë“±ë¡í•˜ëŠ”ë° ì‚¬ìš©í•©ë‹ˆë‹¤. (bookmark ë“±ë¡, message ë“±ê³¼ ê°™ì€ ê¸°ëŠ¥)\n2. Content scripts => í˜„ì¬ ì—´ë ¤ ìˆëŠ” í˜ì´ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ë“¤ì„ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n3. an options page => options pageì— ì˜í•´ ì œê³µë˜ëŠ” ì„¸ë¶€ ë™ì‘ì„ usesrê°€ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.\n4. UI elements => ë¸Œë¼ìš°ì € ìš°ìƒë‹¨ì— ì¡´ì¬í•˜ëŠ” ì•„ì´ì½˜ or í´ë¦­ ì‹œ ì—´ë¦¬ëŠ” popup, ê²€ìƒ‰ì°½, contextmenu ë“±ê³¼ ê´€ë ¨ëœ ìš”ì†Œë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.\n5. various logic files => ì¶”ê°€ì ìœ¼ë¡œ ì‚¬ìš©í•  logic ë“±ì„ í¬í•¨í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\nê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  ìš”ì†ŒëŠ” HTML, CSS, Javascriptë¥¼ ì´ìš©í•´ì„œ êµ¬ì„±ë©ë‹ˆë‹¤. ëª¨ë“  í™•ì¥ componentê°€ í•„ìš”ë¡œ ë˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤.\n\n## 2. Manifest ë§Œë“¤ê¸°\n\nëª¨ë“  extensionì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ manifest íŒŒì¼ì„ í¬í•¨í•©ë‹ˆë‹¤. ì´ëŠ” JSON í˜•ì‹ìœ¼ë¡œ ë˜ì–´ìˆê³ , manifest.jsonì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.  \nê¸°ë³¸ í˜•íƒœëŠ” ë‹¤ìŒ ì œì‹œí•œ ë‚´ìš©ì²˜ëŸ¼ êµ¬ì„±ë©ë‹ˆë‹¤. required ë¶€ë¶„ì—ëŠ” ë°˜ë“œì‹œ ë“¤ì–´ê°€ì•¼ í•˜ëŠ” ë‚´ìš©ì„ í¬í•¨í•©ë‹ˆë‹¤.  \në˜í•œ, appì„ êµ¬ì„±í•¨ì— ìˆì–´ ê±°ì˜ í•„ìˆ˜ì ìœ¼ë¡œ ë“¤ì–´ê°€ì•¼ í•˜ëŠ” actionê³¼ iconê³¼ ê°™ì€ ë‚´ìš©ê³¼ ì„¤ëª… ë“±ì´ í¬í•¨ë©ë‹ˆë‹¤.\n\n```json\n{\n  // required\n  \"manifest_version\": 3,\n  \"name\": \"app test\",\n  \"version\": \"0.0.1\",\n\n  // recommended\n  \"action\": {},\n  \"default_locale\": \"ko\",\n  \"description\": \"chrome extension test\",\n  \"icons\": {}\n}\n```\n\nìì„¸í•œ ì‚¬í•­ì€ í•˜ë‹¨ ë§í¬ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”.\n\n[Chrome extension Manifest](https://developer.chrome.com/docs/extensions/mv3/manifest/)\n\n## 3. Background script êµ¬ì„±í•˜ê¸°\n\ní™•ì¥ì•±ì€ eventì— ê¸°ë°˜ì„ ë‘” í¬ë¡¬ ë¸Œë¼ìš°ì € í™˜ê²½ì„ í–¥ìƒ ë˜ëŠ” ë³€ê²½ ì‹œí‚¤ê¸° ìœ„í•œ í”„ë¡œê·¸ë¨ì´ë‹¤. event(ìƒˆë¡œìš´ pageë¡œì˜ ì´ë™, ë¶ë§ˆí¬ ì‚­ì œ, íƒ­ ë‹«ê¸°, ë“±)ëŠ” browserì— ì˜í•´ì„œ ë“±ë¡ë˜ì–´ì§‘ë‹ˆë‹¤. í™•ì¥ì•±ì€ background (service worker) scriptsë¥¼ ì´ìš©í•˜ì—¬ ì´ëŸ¬í•œ eventë¥¼ ëª¨ë‹ˆí„°ë§í•˜ë©°, íŠ¹ì • ì§€ì‹œì‚¬í•­ì„ ëª…ì‹œí•©ë‹ˆë‹¤.  \nbackground service workerëŠ” í•„ìš”ì— ì˜í•´ ì–¸ì œë“ ì§€ loadë˜ê³ , ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë©´ unloadë©ë‹ˆë‹¤.\n\n- í™•ì¥ì•±ì´ ìµœì´ˆë¡œ ì„¤ì¹˜ë˜ê±°ë‚˜ ì—…ë°ì´íŠ¸ ë˜ì—ˆì„ ê²½ìš°\n- background pageê°€ ì „ì†¡ëœ eventë¥¼ ë“¤ì—ˆì„ ê²½ìš°\n- ë‹¤ë¥¸ script ë˜ëŠ” extensionì—ì„œ messageë¥¼ ì „ì†¡í–ˆì„ ê²½ìš°\n- í™•ì¥ì•±ì˜ ë‹¤ë¥¸ viewì—ì„œ runtime.getBackgroundPageë¥¼ í˜¸ì¶œí•œ ê²½ìš°\n\ní•œë²ˆ loadë˜ë©´, service workerëŠ” ì´ê²ƒì´ actionì„ ìˆ˜í–‰í•˜ëŠ” ë™ì•ˆì€ ì¢…ë£Œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, service workerëŠ” ëª¨ë“  view ê·¸ë¦¬ê³  message portê°€ ë‹«í ë•Œê¹Œì§€ unloadë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\n`viewë¥¼ ì—¬ëŠ” ê²ƒì€ service workerë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ëŠ” ì•Šì§€ë§Œ, ì¢…ë£Œë˜ëŠ” ê²ƒì„ ë§‰ì„ ìˆ˜ëŠ” ìˆìŠµë‹ˆë‹¤.`\n\níš¨ìœ¨ì ì¸ background scriptsëŠ” eventê°€ ë°œë™ë˜ê¸° ê¹Œì§€ëŠ” ì •ì§€ìƒíƒœë¡œ ì¡´ì¬í•˜ê³ , ì´ì— ì‘í•œë’¤ì— ì¢…ë£Œëœë‹¤.\n\n### ë“±ë¡\n\nservice workerë¥¼ ë“±ë¡í•˜ê¸° ìœ„í•´ì„œëŠ” manifestì— ì´ë¥¼ ëª…ì‹œí•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.  \nì•„ë˜ ì˜ˆì œì—ì„œëŠ” ëª…ì‹œëœ background.js íŒŒì¼ì´ service_workerë“¤ì˜ mainì´ ë©ë‹ˆë‹¤.\n\n```json\n{\n    \"manifest_version\": 3,\n    ...,\n    \"background\": {\n          \"service_worker\": \"background.js\"\n    }\n}\n```\n\n### êµ¬ì„±í•˜ê¸°\n\nruntime.onInstalled eventë¥¼ listení•œë‹¤ë©´, í™•ì¥ì•± ì„¤ì¹˜ ì‹œì— ì´ˆê¸°í™”ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ˆê¸° ìƒíƒœë¥¼ ì •ì˜í•  ë•Œ ì´ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.  \nì•„ë˜ ì˜ˆì‹œì—ì„œëŠ” eventë¥¼ ë“±ë¡í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤. ì—¬ê¸°ì„œ ìœ ì˜í•´ì•¼ í•  ê²ƒì€ eventì˜ ë“±ë¡ì€ pageì˜ ì‹œì‘ ì‹œì— ë™ê¸°ì ìœ¼ë¡œ ëª¨ë‘ ì„¤ì¹˜í•´ì£¼ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë§Œì•½, eventê°€ ë°œìƒí–ˆì„ ë•Œ, eventë¥¼ ë“±ë¡í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë™ì‘ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ë¥¸ ë°©ì‹ì„ ì´ìš©í•´ì•¼ í•©ë‹ˆë‹¤.\n\n```javascript\nchrome.runtime.onInstalled.addListener(function() {\n  chrome.contextMenus.create({\n    \"id\": \"sampleContextMenu\",\n    \"title\": \"Sample Context Menu\",\n    \"contexts\": [\"selection\"]\n  });\n});\n\n// This will run when a bookmark is created.\nchrome.bookmarks.onCreated.addListener(function() {\n  // do something\n});\n```\n\nì¶”ê°€ì ìœ¼ë¡œ ìš”ì²­ì„ filtering í•˜ê±°ë‚˜, triggerë¥¼ ì¬ë“±ë¡í•˜ëŠ” ê³¼ì •ê³¼ ê°™ì€ ë‚´ìš©ì€ í•˜ë‹¨ ë§í¬ë¥¼ ì¶”ê°€ë¡œ ì°¸ê³ í•˜ê¸° ë°”ëë‹ˆë‹¤.\n\n[Background pages](https://developer.chrome.com/docs/extensions/mv3/background_pages/)\n\n## 4. Content scripts ë§Œë“¤ê¸°\n\ncontents scriptsëŠ” web pageì—ì„œ ë™ì‘í•  ë‚´ìš©ì— ëŒ€í•œ ë‚´ìš©ì„ ë‹´ìŠµë‹ˆë‹¤. DOMì„ ì‚¬ìš©í•˜ì—¬, scriptsëŠ” í˜„ì¬ ì›¹ í˜ì´ì§€ì˜ ì„¸ë¶€ì‚¬í•­ì„ ì¡°íšŒ, ë³€ê²½ ë˜ëŠ” ì •ë³´ë¥¼ ì „ë‹¬í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.  \ncontens scriptsëŠ” í™•ì¥ì•±ì˜ message êµí™˜ì„ í†µí•´ì„œ ë¶€ëª¨ í™•ì¥ì•±ì— ì˜í•´ ì‚¬ìš©ë˜ëŠ” chrome APIì— ì ‘ê·¼í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë˜í•œ, URLì„ í†µí•´ì„œ í™•ì¥ì•±ì˜ íŒŒì¼ì— ì ‘ê·¼í•˜ì—¬, ì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ i18n, storage, runtime(connect, getURL, id, onMessage, sendMessage, etc...) ê³¼ ê°™ì€ APIì— ë°”ë¡œ ì ‘ê·¼í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\n```javascript\n// Code for displaying <extensionDir>/images/myimage.png:\nvar imgURL = chrome.runtime.getURL(\"images/myimage.png\");\ndocument.getElementById(\"someImage\").src = imgURL;\n```\n\n### ê³ ë¦½\n\në‹¤ë¥¸ í™•ì¥ì•±, ë˜ëŠ” pageì™€ ì¶©ëŒì„ ë§‰ê¸° ìœ„í•´ì„œ ê¸°ë³¸ì ìœ¼ë¡œ content scriptëŠ” ê³ ë¦½ë©ë‹ˆë‹¤. (browserì˜ tabê°„ì— ì„œë¡œ ë…ë¦½ì ì¸ ê²ƒì²˜ëŸ¼)  \nì˜ˆë¥¼ ë“¤ì–´, ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œê°€ ìˆë‹¤ê³  ê°€ì •í•©ë‹ˆë‹¤.\n\n```html\n<html>\n  <button id=\"mybutton\">click me</button>\n  <script>\n    var greeting = \"hello, \";\n    var button = document.getElementById(\"mybutton\");\n    button.person_name = \"Bob\";\n    button.addEventListener(\"click\", () =>\n      alert(greeting + button.person_name + \".\")\n    , false);\n  </script>\n</html>\n```\n\nì—¬ê¸°ì— content scriptsë¥¼ ì´ìš©í•´ì„œ ì•„ë˜ ì½”ë“œë¥¼ injectí•œë‹¤ë©´,\n\n```javascript\nvar greeting = \"hola, \";\nvar button = document.getElementById(\"mybutton\");\nbutton.person_name = \"Roberto\";\nbutton.addEventListener(\"click\", () =>\n  alert(greeting + button.person_name + \".\")\n, false);\n```\n\nbuttonì„ í´ë¦­í–ˆì„ ë•Œ, ë‘ ê°œì˜ alert ì°½ì„ ë§Œë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n### Inject scripts\n\ncontent scriptsëŠ” 3ê°€ì§€ì˜ ë°©ë²•ìœ¼ë¡œ ì‚½ì…ë˜ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n> **1. statically**\n\nmanifest.json íŒŒì¼ì— ì •ì ìœ¼ë¡œ ì„ ì–¸í•˜ë©´, ìë™ì ìœ¼ë¡œ pageê°€ settingë  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì´ëŠ” \"content\\_scripts\"ë¼ëŠ” ë¶€ë¶„ì— ì •ì˜ë©ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” javascript, css ë“±ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```json\n{\n\"manifest_version\": 3,\n...\n\"content_scripts\": [\n  {\n    \"matches\": [\"http://*.nytimes.com/*\"], // í•´ë‹¹ injectionì„ ìˆ˜í–‰í•  URLì„ ëª…ì‹œí•©ë‹ˆë‹¤. í•„ìˆ˜ì…ë ¥ì…ë‹ˆë‹¤.\n    \"css\": [\"myStyles.css\"], // ì¶”ê°€í•  cssíŒŒì¼ ì…ë‹ˆë‹¤.\n    \"js\": [\"contentScript.js\"] // ì¶”ê°€í•  jsíŒŒì¼ ì…ë‹ˆë‹¤.\n  }\n]\n}\n```\n\n> **2. dynamically**\n\n2021.04.01 ì‹œì ì—ì„œëŠ” ì•„ì§ ì™„ì „ ì œê³µí•˜ì§€ëŠ” ì•ŠëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.  \nhostë¥¼ ì•Œì§€ ëª»í•˜ê±°ë‚˜ ì•„ëŠ” hostë¡œ ë¶€í„° scriptê°€ ì¶”ê°€ ë˜ëŠ” ì‚­ì œë  í•„ìš”ê°€ ìˆëŠ” ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.\n\n`chrome.scripting.registerContentScript(optionsObject, callback);`\n\nor\n\n`chrome.scripting.unregisterContentScript(idArray, callback);`\n\n> **3. programmatically**\n\nêµ¬ì²´ì ì¸ ìƒí™© ë˜ëŠ” eventì— ëŒ€í•œ ë°˜ì‘ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ì›í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.  \nì´ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ì„œëŠ”, í•´ë‹¹ í˜ì´ì§€ì— ëŒ€í•œ hostì˜ permissionì´ í•„ìš”í•©ë‹ˆë‹¤. ì´ëŠ” í™•ì¥ì•±ì˜ host\\_permissions ë¶€ë¶„ or ì¼ì‹œì ìœ¼ë¡œ activeTabì„ ì´ìš©í•´ì„œ ìŠ¹ì¸ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n```json\n{\n  \"manifest_version\": 3,\n  ...\n  \"permissions\": [\n    \"activeTab\"\n  ]\n}\n```\n\n```javascript\n// 1. íŒŒì¼ ì „ì²´ë¥¼ ì‹¤í–‰ ì£¼ì… ì‹œí‚¤ëŠ” ë°©ë²•\nchrome.runtime.onMessage.addListener((message, callback) => {\n  if (message == \"runContentScript\"){\n    chrome.scripting.executeScript({\n      file: 'contentScript.js'\n    });\n  }\n});\n\n// 2. íŠ¹ì • í•¨ìˆ˜ë¥¼ ì£¼ì…í•˜ëŠ” ë°©ë²•\nfunction injectedFunction(color) {\n  document.body.style.backgroundColor = color;\n}\n\nchrome.runtime.onMessage.addListener((message, callback) => {\n  if (message == \"changeColor\"){\n    chrome.scripting.executeScript({\n      function: injectedFunction,\n      arguments: ['orange']\n    });\n  }\n});\n```\n\nì¶”ê°€ì ìœ¼ë¡œ matck ë²”ìœ„ë¥¼ ì„¸ë¶€ ì •ì˜í•˜ëŠ” ë¶€ë¶„ê³¼ frame ë° rum time ì‹œì  ê´€ë ¨ ì‚¬í•­ì€ ì•„ë˜ ë§í¬ë¥¼ ì°¸ì¡°í•´ì£¼ì„¸ìš”.\n\n[Content scripts](https://developer.chrome.com/docs/extensions/mv3/content_scripts/)\n\n## 5. option Page ë§Œë“¤ê¸°\n\nì‚¬ìš©ìì—ê²Œ optionì„ ì„ íƒí•  ìˆ˜ ìˆëŠ” pageë¥¼ customiseí•˜ì—¬ ì œê³µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” chrome í™•ì¥ì•±ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” chrome://extensionsì—ì„œ Detailì„ ëˆŒë €ì„ ë•Œ ë³´ì´ëŠ” optionê³¼ ê´€ë ¨ëœ pageì…ë‹ˆë‹¤.  \nì´ëŠ” í•„ìš”ì— ë”°ë¼ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì•Œë§ê¸° ë•Œë¬¸ì— ë§í¬ë§Œ ë‹¬ì•„ë‘ê² ìŠµë‹ˆë‹¤.\n\n[Options](https://developer.chrome.com/docs/extensions/mv3/options/)\n\n## 6. UI elements ë§Œë“¤ê¸°\n\ní™•ì¥ì•±ì€ UI ìš”ì†Œë¥¼ ëª‡ ê°€ì§€ ì œê³µí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œëŠ” ì¼ë¶€ë§Œ ì†Œê°œí•©ë‹ˆë‹¤.\n\n### 1. Badge\n\ní™•ì¥ì•±ì˜ iconì„ ê²°ì •í•˜ê±°ë‚˜, í™œì„±í™” / ë¹„í™œì„±í™” ë“±ì„ êµ¬ë¶„í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. => ìƒì„¸ ë‚´ìš©ì€ í•˜ë‹¨ ë§í¬ ì°¸ê³   \nì—¬ê¸°ì„œëŠ” iconì„ ì„¤ì •í•˜ëŠ” ë°©ë²•ë§Œ ì ìŠµë‹ˆë‹¤.\n\n```json\n{\n  \"manifest_version\": 3,\n  ...\n  \"icons\": {\n    \"16\": \"extension_icon16.png\", // favicon\n    \"32\": \"extension_icon32.png\", // ê´€ë¦¬ì°½ Icon(windowì—ì„œ ê°€ë” ìš”êµ¬í•¨)\n    \"48\": \"extension_icon48.png\", // ê´€ë¦¬ì°½ Icon\n    \"128\": \"extension_icon128.png\" // chrome webstore Icon\n  }\n}\n```\n\n### 2. Popup\n\nbrowser ì°½ì˜ tooltipì„ í´ë¦­ ì‹œì— ë³´ì—¬ì£¼ê³  ì‹¶ì€ ë‚´ìš©ì„ ëª…ì‹œí•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\n```json\n{\n  \"manifest_version\": 3,\n  ...\n  \"browser_action\": {\n    \"default_popup\": \"popup.html\"\n  }\n  ...\n}\n```\n\npopup.html\n\n```html\n<html>\n  <head>\n    <title>Water Popup</title>\n  </head>\n  <body>\n      <img src='./stay_hydrated.png' id='hydrateImage'>\n      <button id='sampleSecond' value='0.1'>Sample Second</button>\n      <button id='15min' value='15'>15 Minutes</button>\n      <button id='30min' value='30'>30 Minutes</button>\n      <button id='cancelAlarm'>Cancel Alarm</button>\n    <script src=\"popup.js\"></script>\n  </body>\n</html>\n```\n\n### 3. Contextmenu\n\nìš°í´ë¦­ ì‹œì— ë‚˜ì˜¤ëŠ” ìƒìì— ì¶”ê°€ ë‚´ìš©ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\n```json\n{\n  \"manifest_version\": 3,\n  ...\n  \"permissions\": [\n    \"contextMenus\"\n  ],\n  \"background\": {\n    \"service_worker\": \"background.js\"\n  }\n}\n```\n\n`background.js`\n\n```javascript\nconst kLocales = {\n  'com.au': 'Australia',\n  'com.br': 'Brazil',\n  'ca': 'Canada',\n  'cn': 'China',\n  'fr': 'France',\n  'it': 'Italy',\n  'co.in': 'India',\n  'co.jp': 'Japan',\n  'com.ms': 'Mexico',\n  'ru': 'Russia',\n  'co.za': 'South Africa',\n  'co.uk': 'United Kingdom'\n};\n\nchrome.runtime.onInstalled.addListener(function() {\n  for (let key of Object.keys(kLocales)) {\n    chrome.contextMenus.create({\n      id: key,\n      title: kLocales[key],\n      type: 'normal',\n      contexts: ['selection'],\n    });\n  }\n});\n```\n\nì¶”ê°€ì ìœ¼ë¡œ, override page, command, ê²€ìƒ‰ì°½ ë””ìì¸ ë“± ì¶”ê°€ì ì¸ ìš”ì†Œë¥¼ ë³´ë ¤ë©´ ì•„ë˜ ë§í¬ë¥¼ ì°¸ì¡°í•´ì£¼ì„¸ìš”.\n\n[Design the user interface](https://developer.chrome.com/docs/extensions/mv3/user_interface/)\n\n## 7. Boilerplate\n\në§Œì•½, react, typescriptì— ìµìˆ™í•˜ë‹¤ë©´, í•„ìê°€ ë§Œë“¤ì–´ë†“ì€ boilerplateë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.\n\n[euidong/chrome-extension-boilerplate](https://github.com/euidong/chrome-extension-boilerplate)\n","slug":"chrome-extension","date":"2021-04-01 17:27","title":"Chrome Extension","category":"Web","tags":["ChromeExtension"],"desc":"í•´ë‹¹ ê¸€ì€ manifest version 3ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±ëœ ê¸€ì…ë‹ˆë‹¤. í˜¹ì—¬ version 2ë¥¼ ì´ìš©í•˜ì…¨ë‹¤ë©´, version 2ì—ì„œ version 3ë¡œ migration í•˜ë©´ì„œ ì œê°€ ì ì–´ë†“ì€ ê¸€ì´ ìˆìœ¼ë‹ˆ ê·¸ê²ƒì„ ì°¸ê³  í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.[Chrome Extension version migration from V2 to V3](/posts/chrome-extension-migration-v2-to-v3)","thumbnailSrc":"https://euidong.github.io/images/chrome-extension.jpeg"},"relatedPosts":[{"content":"\n## Intro\n\nìµœê·¼ 3ì¼ ì •ë„ë¥¼ chrome extension version 2ì—ì„œ version3ë¡œ migrationí•˜ë©´ì„œ ë³´ë‚¸ ê±° ê°™ìŠµë‹ˆë‹¤. ã… ã… \n\ní˜„ì¬ side projectë¡œ ì§„í–‰í•˜ê³  ìˆëŠ” ë‚´ìš©ì„ chrome extension storeì— ë°°í¬í• ë ¤ê³  í•˜ëŠ” ìˆœê°„ì— ê²½ê³ ì°½ì´ ëœ¨ë©°, ì´ì œë¶€í„°ëŠ” version 3ë§Œ ì—…ë¡œë“œë¥¼ ì§€ì›í•œë‹¤ëŠ” ê²½ê³ ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤.ã… ã… ã… ã… ã… \n\nê·¸ë˜ì„œ ì´ì „ ì…‹ì—…ì„ ì™„ì „íˆ ëœ¯ì–´ê³ ì³ì•¼ ëœë‹¤ëŠ” ê²°ë¡ ì— ë„ë‹¬í–ˆê³ , ì´ì „ì— ì—´ì‹¬íˆ íˆ¬ë‹¥íˆ¬ë‹¥ ë§Œë“¤ì—ˆë˜ ê²°ê³¼ë¬¼ì„ ë‹¤ì‹œ ëœ¯ì–´ê³ ì³ì•¼í–ˆìŠµë‹ˆë‹¤.\n\nì´ ë‚´ìš©ì€ ì œê°€ ì§„í–‰í•˜ë©´ì„œ ë°”ê¾¼ ë‚´ìš©ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤. ì €ì™€ ê°™ì´ version migrationì„ ì§„í–‰í•˜ì‹œëŠ” ë¶„ë“¤ì—ê²Œ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.\n\n## 1. manifestì—ì„œ ë°”ë€Œì–´ì•¼ í•˜ëŠ” ë¶€ë¶„\n\nìœ„ì—ê°€ ê¸°ì¡´ version 2ë¼ë©´ ì•„ë˜ê°€ version 3ë¡œ ë°”ë€Œì—ˆì„ ë•Œì˜ ë‚´ìš©ì…ë‹ˆë‹¤. ì¼ë‹¨ ìš©ì–´ì ì¸ ë¶€ë¶„ì—ì„œ ì—„ì²­ ë³€ê²½ëœ ê²ƒì€ ì—†ìŠµë‹ˆë‹¤. (í•˜ì§€ë§Œ, API callì´ë¼ë“ ì§€ ê¸°íƒ€ ì—¬ëŸ¬ ë¶€ë¶„ì— ê´€í•´ì„œëŠ” ì •ì±…ì´ ë§¤ìš° ê°•ë ¥í•´ì§„ í¸ì…ë‹ˆë‹¤. ì´ëŠ” ë°”ë¡œ ë‹¤ìŒì— ì‚´í´ë´…ë‹ˆë‹¤.)\n\n```json\n// manifest.json\n{\n  \"manifest_version\": 2,\n  \"name\": \"chrome-ext-boiler-plate\",\n  \"version\": \"0.0.1\",\n  \"description\": \"This project is chrome extension boiler plate\",\n  \"icons\": {\n    \"16\": \"icon/16.png\",\n    \"32\": \"icon/32.png\",\n    \"48\": \"icon/48.png\",\n    \"128\": \"icon/128.png\"\n  },\n  \"background\": { \"scripts\": [\"background.js\"] },\n  \"content_scripts\": [{ \"matches\": [\"<all_urls>\"], \"js\": [\"content.js\"] }],\n  \"options_page\": \"option.html\",\n  \"browser_action\": { \"default_popup\": \"popup.html\" },\n  \"permissions\": [\"storage\", \"tabs\"],\n  \"content_security_policy\": \" script-src 'self' 'unsafe-eval'; object-src 'self'\"\n}\n```\n\n```json\n// manifest.json\n{\n  \"manifest_version\": 3,\n  \"name\": \"chrome-ext-boiler-plate\",\n  \"version\": \"0.0.1\",\n  \"description\": \"This project is chrome extension boiler plate\",\n  \"icons\": {\n    \"16\": \"icon/16.png\",\n    \"32\": \"icon/32.png\",\n    \"48\": \"icon/48.png\",\n    \"128\": \"icon/128.png\"\n  },\n  \"background\": { \"service_worker\": \"background.js\" },\n  \"content_scripts\": [{ \"matches\": [\"<all_urls>\"], \"js\": [\"content.js\"] }],\n  \"options_page\": \"option.html\",\n  \"permissions\": [\"storage\", \"tabs\"],\n  \"action\": { \"default_popup\": \"popup.html\" }\n}\n```\n\n> **ìš”ì•½**\n\n- manifest\\_version : 2 => 3\n- background.scripts => background.service\\_worker  \n  ë°°ì—´ì—ì„œ í•˜ë‚˜ì˜ ë‹¨ì¼ service\\_workerë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ê¸°ì¡´ì— permanentê´€ë ¨ ì„¤ì •ì„ í•˜ì‹  ë¶„ë“¤ì€ ì´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n-Â browser_action => action  \n  ê¸°ì¡´ì— ìˆë˜ ë‹¤ë¥¸ actionê³¼ í†µí•©ë˜ì–´ í•˜ë‚˜ì˜ actionì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ëª…ì¹­ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ì‚¬ì‹¤ ì—¬ê¸°ê¹Œì§€ëŠ” í™”ê°€ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n\n## 2. ë³´ì•ˆ ì„¤ì •\n\nversion 3ë¡œ ì˜¬ë¼ì˜¤ë©´ì„œ ë³´ì•ˆì •ì±…ì´ ì •ë§ ê°•í™”ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.\n\níŠ¹íˆ CORS ë¶€ë¶„ì—ì„œ 1ì°¨ ë©˜ë¶•ì„ ê²ªì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\në§Œì•½, serverì—ì„œ ê¸°ì¡´ì˜ CORS acceptë¥¼ ë‹¨ìˆœíˆ \"\\*\"ë¡œ ì„¤ì •í•˜ì˜€ë‹¤ë©´, ì €ì²˜ëŸ¼ ê°œê³ ìƒì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¼ë‹¨, popupì—ì„œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²½ìš°ì— ì €ëŠ” \"chrome-extension://\\*\" ë¡œ ì„¤ì •ì„ ì§ì ‘ì ìœ¼ë¡œ í•´ì£¼ì–´ì•¼ ì œëŒ€ë¡œ í†µì‹ ì„ í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ì´ê±° ì§„ì§œ ë„ˆë¬´ í˜ë“¤ê²Œ ì°¾ì•˜ìŠµë‹ˆë‹¤. ã… ã…  (ì„œë²„ ë‹¨ì—ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì œì¸ì§€ ì•„ë‹ˆë©´, ë‹¤ë¥¸ ì„¤ì • ë¬¸ì œì¸ì§€ëŠ” ì²´í¬ëŠ” ì•ˆí–ˆìŠµë‹ˆë‹¤. ã… ì—¬ëŸ¬ë¶„ë„ ì¡°ì‹¬í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.)\n\në˜í•œ, websocket ì„¤ì •ë„ êµ‰ì¥íˆ ë¹¡ì„¸ì¡ŒìŠµë‹ˆë‹¤. ê¸°ì¡´ì—ëŠ” wss ìš”ì²­ì„ ë³´ë‚¼ ë•Œ, INVALID CERTIFICATEë¥¼ í™•ì¸í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ì¸ì¦ì„œ ëŒ€ì¶© ì„¤ì •í•˜ê³  ì§„í–‰í–ˆì—ˆëŠ”ë°, ì´ì œëŠ” backgroundì—ì„œ connection ìƒì„± ì‹œì— ì´ë¥¼ ë°˜ë“œì‹œ í™•ì¸í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, https ìƒì„± í•˜ì‹¤ ë•Œ ì„œëª… í™•ì‹¤í•˜ê²Œ í•˜ì‹œê³ , ì„¤ì •í•˜ì‹œëŠ”ê²Œ ì¢‹ì„ ê²ë‹ˆë‹¤. (ì €ëŠ” traefikì„ ì´ìš©í•˜ëŠ”ë° ì•Œì•„ì„œ ì¸ì¦ì„œ ë°œê¸‰ í•´ì£¼ëŠ” ê²Œ ë„ˆë¬´ í¸ë¦¬í•©ë‹ˆë‹¤.)\n\n![chrome-ext-mig-01](/images/chrome-ext-mig-01.png)\n\n## 3. Webpack ì„¤ì •\n\nìš”ì¦˜ ê°™ì€ ì‹œëŒ€ì— ìƒ javascript, jQueryë¡œ frontë¥¼ ê°œë°œí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì—, webpackì„ í†µí•´ì„œ vueë‚˜ reactë¥¼ ì‚¬ìš©í•˜ì‹¤ ê°€ëŠ¥ì„±ì´ ë†’ìœ¼ì‹¤ ê²ë‹ˆë‹¤. ë†€ë¼ìš´ ì‚¬ì‹¤ì€ ìš°ë¦¬ì˜ webpackì´ ì•„ë¬´ ì„¤ì •ì„ í•´ì£¼ì§€ ì•Šìœ¼ë©´ development modeì—ì„œëŠ” build fileë¡œ evalì´ ì”ëœ© ë•ì¹ ë˜ì–´ ìˆëŠ” ì½”ë“œë¥¼ return í•©ë‹ˆë‹¤.\n\n![chrome-ext-mig-02](/images/chrome-ext-mig-02.png)\n\nê·¸ëŸ°ë°, ì´ë²ˆ v3ì—ì„œëŠ” evalì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë³´ì•ˆìƒì˜ ìœ„í˜‘ìœ¼ë¡œ ì²´í¬í•˜ê³ , ê°œë°œìƒí™©ì—ì„œë„ í—ˆìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. (ë¬¼ë¡  sandboxë¡œ ì„¤ì •í•´ì„œ í•  ìˆ˜ ìˆì§€ë§Œ, ì´ë ‡ê²Œ ë˜ë©´ manifest.json fileì„ development, production êµ¬ë¶„í•´ì•¼í•˜ê³ , ì¼ë‹¨ ì´ì— ëŒ€í•œ ì˜ˆì œë¥¼ ì œê°€ ì°¾ì§€ ëª»í–ˆê¸° ë•Œë¬¸ì— ì´ë¥¼ í†µí•œ ì„¤ì •ì€ ì €ëŠ” í¬ê¸°í–ˆìŠµë‹ˆë‹¤. ã… ) ê¸°ì¡´ì—ëŠ”Â  manifestì—ì„œ content\\_security\\_policyì—ì„œ evalì„ í—ˆìš©í•´ì£¼ë©´ ëì´ì˜€ëŠ”ë°, version 3ë¡œ ë°”ë€Œë©´ì„œ sandboxë¼ëŠ” ê¸°ëŠ¥ì´ ì¶”ê°€ë˜ë©´ì„œ, ì €í¬ë¥¼ ê³¤í˜¹ìŠ¤ëŸ½ê²Œ í•©ë‹ˆë‹¤. ì¼ë‹¨ ì°¾ê¸° ì‰¬ìš´ ì˜ˆì œë¡œ sandboxì— ì ìš©í•˜ë‹ˆ chrome APIê°€ ë§‰íˆê±°ë‚˜, http API callì´ ë§‰íˆëŠ” ë“± ì €ë¥¼ ë„ˆë¬´ë‚˜ í˜ë“¤ê²Œ í–ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì €ëŠ” webpack ì„¤ì •ì„ ë§Œì ¸ì„œ ë‹¤ì‹œ ê³ ì³ì“°ìëŠ” ê²°ë¡ ì„ ë‚´ë ¸ê³ , ê²€ìƒ‰ê³¼ ê²€ìƒ‰ê³¼ ë” ê²€ìƒ‰ì„ ê±°ì¹œ ê²°ê³¼ë¡œ webpack.config.jsì—ì„œ evalì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” modeë¥¼ ì°¾ì•„ëƒˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì ìš©í•œ ê²°ê³¼ ì§„ì§œë¡œ evalì´ ì‚¬ë¼ì¡Œê³ , build ì†ë„ë„ êµ‰ì¥íˆ ë¹¨ëê¸°ì— ì•„ì£¼ ê¸°ë¶„ ì¢‹ê²Œ ì„¤ì •ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤. ê»„ê»„..\n\nì•„ë˜ëŠ” devtoolsë¥¼ cheap-module-source-mapìœ¼ë¡œ ì„¤ì •í–ˆì„ ë•Œ ë‚˜ì˜¤ëŠ” ê²°ê³¼ë¬¼ì…ë‹ˆë‹¤. ì •ë§ ë‹¤í–‰íˆë„ evalì´ ì—†ìŠµë‹ˆë‹¤.\n\n![chrome-ext-mig-03](/images/chrome-ext-mig-03.png)\n\në§ˆë¬´ë¦¬í•˜ë©´ì„œ, ë‹¤ ë‚˜ìœì ë§Œ ìˆì—ˆë˜ ê²ƒì€ ì•„ë‹ˆë¼ëŠ” ì ì„ ì§šì–´ë³´ê³  ë„˜ì–´ê°‘ë‹ˆë‹¤. ê¸°ì¡´ì—ëŠ” webpack pluginì¸ webpack-chrome-extension-reloader ë¥¼ ì´ìš©í•´ì„œ hot reloadingì„ êµ¬í˜„í–ˆì—ˆëŠ”ë°, version3ë¡œ ë„˜ì–´ê°€ë©´ì„œ codeê°€ ë°”ë€Œë©´ ìë™ìœ¼ë¡œ í•´ì¤€ë‹¤ëŠ” ê²ƒì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, webpack --watch ë§Œ ì„¤ì •í•´ì¤˜ë„ ì‰½ê²Œ reloadingì´ ë©ë‹ˆë‹¤. ì•„ë§ˆ chromeì—ì„œ íŒŒì¼ ë³€í™˜ì´ ìƒê¸°ë©´ ìë™ìœ¼ë¡œ reloading í•˜ëŠ” ê±° ê°™ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ì„¤ì •ì€ ì§€ì›Œì£¼ì—ˆìŠµë‹ˆë‹¤.\n\nì´ë ‡ê²Œ í•´ì„œ ê±°ì˜ í•œ 3ì¼ ì •ë„ ê³¨ë¨¸ë¦¬ë¥¼ ì•“ìœ¼ë©´ì„œ migrationí•œ ë‚´ìš©ì„ ì •ë¦¬í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ë¶„ë“¤ì—ê²Œë„ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ë„¤ìš”.\n\në§ˆì§€ë§‰ìœ¼ë¡œ github linkì…ë‹ˆë‹¤. ì´ê±° ë³´ê³  ì°¸ê³  í•˜ì‹œëŠ”ê²Œ ê°€ì¥ ë¹ ë¥¼ ê±° ê°™ìŠµë‹ˆë‹¤.\n\n[ğŸ”— GitHub](https://github.com/euidong/chrome-extension-boilerplate)\n","slug":"chrome-extension-migration-v2-to-v3","date":"2022-02-14 21:25","title":"Chrome Extension Migrantion V2ì—ì„œ V3","category":"Web","tags":["ChromeExtension"],"desc":"ìµœê·¼ 3ì¼ ì •ë„ë¥¼ chrome extension version 2ì—ì„œ version3ë¡œ migrationí•˜ë©´ì„œ ë³´ë‚¸ ê±° ê°™ìŠµë‹ˆë‹¤. ã… ã… í˜„ì¬ side projectë¡œ ì§„í–‰í•˜ê³  ìˆëŠ” ë‚´ìš©ì„ chrome extension storeì— ë°°í¬í• ë ¤ê³  í•˜ëŠ” ìˆœê°„ì— ê²½ê³ ì°½ì´ ëœ¨ë©°, ì´ì œë¶€í„°ëŠ” version 3ë§Œ ì—…ë¡œë“œë¥¼ ì§€ì›í•œë‹¤ëŠ” ê²½ê³ ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤.ã… ã… ã… ã… ã… ê·¸ë˜ì„œ ì´ì „ ì…‹ì—…ì„ ì™„ì „íˆ ëœ¯ì–´ê³ ì³ì•¼ ëœë‹¤ëŠ” ê²°ë¡ ì— ë„ë‹¬í–ˆê³ , ì´ì „ì— ì—´ì‹¬íˆ íˆ¬ë‹¥íˆ¬ë‹¥ ë§Œë“¤ì—ˆë˜ ê²°ê³¼ë¬¼ì„ ë‹¤ì‹œ ëœ¯ì–´ê³ ì³ì•¼í–ˆìŠµë‹ˆë‹¤.ì´ ë‚´ìš©ì€ ì œê°€ ì§„í–‰í•˜ë©´ì„œ ë°”ê¾¼ ë‚´ìš©ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤. ì €ì™€ ê°™ì´ version migrationì„ ì§„í–‰í•˜ì‹œëŠ” ë¶„ë“¤ì—ê²Œ ë„ì›€ì´ ë˜ì—ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤.","thumbnailSrc":"https://euidong.github.io/images/chrome-extension.jpeg"}]},"__N_SSG":true}